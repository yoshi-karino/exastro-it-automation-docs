.. image:: ./general_operations/image1.png
   :width: 3.35079in
   :height: 0.78559in

ITA_利用手順マニュアル

RestAPI

*－*\ 第1.10版\ *－*

Copyright © NEC Corporation 2019. All rights reserved.

免責事項

本書の内容はすべて日本電気株式会社が所有する著作権に保護されています。

本書の内容の一部または全部を無断で転載および複写することは禁止されています。

本書の内容は将来予告なしに変更することがあります。

日本電気株式会社は、本書の技術的もしくは編集上の間違い、欠落について、一切責任を負いません。

日本電気株式会社は、本書の内容に関し、その正確性、有用性、確実性その他いかなる保証もいたしません。

商標

-  LinuxはLinus
      Torvalds氏の米国およびその他の国における登録商標または商標です。

-  Red Hatは、Red Hat,
      Inc.の米国およびその他の国における登録商標または商標です。

-  Apache、Apache Tomcat、Tomcatは、Apache Software
      Foundationの登録商標または商標です。

-  Ansibleは、Red Hat, Inc.の登録商標または商標です。

-  Active Directoryは、米国Microsoft
      Corporationの米国およびその他の国における登録商標または商標です。

その他、本書に記載のシステム名、会社名、製品名は、各社の登録商標もしくは商標です。

なお、® マーク、TMマークは本書に明記しておりません。

※本書では「Exastro IT Automation」を「ITA」として記載します。

目次
====

`目次 <#目次>`__ `2 <#目次>`__

`はじめに <#はじめに>`__ `5 <#はじめに>`__

`1 ITAシステム　REST APIの概要 <#itaシステム-rest-apiの概要>`__
`6 <#itaシステム-rest-apiの概要>`__

`1.1 REST APIについて <#rest-apiについて>`__ `6 <#rest-apiについて>`__

`2 標準REST機能の利用 <#標準rest機能の利用>`__
`7 <#標準rest機能の利用>`__

`2.1 リクエストの形式 <#リクエストの形式>`__ `7 <#リクエストの形式>`__

`2.2 利用可能なメソッドとコマンド <#利用可能なメソッドとコマンド>`__
`9 <#利用可能なメソッドとコマンド>`__

`(1) GET（Method） <#getmethod>`__ `9 <#getmethod>`__

`(2) INFO(X-Command) <#infox-command>`__ `11 <#infox-command>`__

`(3) FILTER・FILTER_DATAONLY
(X-Command) <#filterfilter_dataonly-x-command>`__
`11 <#filterfilter_dataonly-x-command>`__

`(4) EDIT(X-Command) <#editx-command>`__ `16 <#editx-command>`__

`(5) LIST_OPTIONS(X-Command) <#list_optionsx-command>`__
`24 <#list_optionsx-command>`__

`(6) DOWNLOAD_SPREADSHEET(X-Command) <#download_spreadsheetx-command>`__
`24 <#download_spreadsheetx-command>`__

`(7) UPLOAD_SPREADSHEET(X-Command) <#upload_spreadsheetx-command>`__
`24 <#upload_spreadsheetx-command>`__

`3
メニューエクスポート/インポート利用編 <#メニューエクスポートインポート利用編>`__
`24 <#メニューエクスポートインポート利用編>`__

`3.1
メニューエクスポートを対象としたRestAPI <#メニューエクスポートを対象としたrestapi>`__
`24 <#メニューエクスポートを対象としたrestapi>`__

`3.1.1 リクエストの形式 <#リクエストの形式-1>`__
`24 <#リクエストの形式-1>`__

`3.1.2 INFO <#info>`__ `24 <#info>`__

`3.1.3 EXECUTE <#execute>`__ `24 <#execute>`__

`3.2
メニューインポートを対象としたRestAPI <#メニューインポートを対象としたrestapi>`__
`24 <#メニューインポートを対象としたrestapi>`__

`3.2.1 リクエストの形式 <#リクエストの形式-2>`__
`24 <#リクエストの形式-2>`__

`3.2.2 UPLOAD <#upload>`__ `24 <#upload>`__

`3.2.3 EXECUTE <#execute-1>`__ `24 <#execute-1>`__

`4
Excel一括エクスポート/インポート利用編 <#excel一括エクスポートインポート利用編>`__
`24 <#excel一括エクスポートインポート利用編>`__

`4.1
Execl一括エクスポートを対象としたRestAPI <#execl一括エクスポートを対象としたrestapi>`__
`24 <#execl一括エクスポートを対象としたrestapi>`__

`4.1.1 リクエストの形式 <#リクエストの形式-3>`__
`24 <#リクエストの形式-3>`__

`4.1.2 INFO <#info-1>`__ `24 <#info-1>`__

`4.1.3 EXECUTE <#execute-2>`__ `24 <#execute-2>`__

`4.2
Excel一括インポートを対象としたRestAPI <#excel一括インポートを対象としたrestapi>`__
`24 <#excel一括インポートを対象としたrestapi>`__

`4.2.1 リクエストの形式 <#リクエストの形式-4>`__
`24 <#リクエストの形式-4>`__

`4.2.2 UPLOAD <#upload-1>`__ `24 <#upload-1>`__

`4.2.3 EXECUTE <#execute-3>`__ `24 <#execute-3>`__

`5 Symphony利用編 <#symphony利用編>`__ `24 <#symphony利用編>`__

`5.1
Symphony登録作業を対象としたRestAPI <#symphony登録作業を対象としたrestapi>`__
`24 <#symphony登録作業を対象としたrestapi>`__

`5.1.1 リクエストの形式 <#リクエストの形式-5>`__
`24 <#リクエストの形式-5>`__

`5.1.2 INFO <#info-2>`__ `24 <#info-2>`__

`5.1.3 FILTER・FILTER_DATAONLY <#filterfilter_dataonly>`__
`24 <#filterfilter_dataonly>`__

`5.1.4 EDIT <#edit>`__ `24 <#edit>`__

`5.2
Symphony作業実行を対象としたRestAPI <#symphony作業実行を対象としたrestapi>`__
`24 <#symphony作業実行を対象としたrestapi>`__

`5.2.1 リクエストの形式 <#リクエストの形式-6>`__
`24 <#リクエストの形式-6>`__

`5.2.2 レスポンスの項目 <#レスポンスの項目>`__
`24 <#レスポンスの項目>`__

`5.2.3 EXECUTE <#execute-4>`__ `24 <#execute-4>`__

`5.2.4 CANCEL <#cancel>`__ `24 <#cancel>`__

`5.2.5 SCRAM <#scram>`__ `24 <#scram>`__

`5.2.6 RELEASE <#release>`__ `24 <#release>`__

`5.3
Symphony作業確認を対象としたRestAPI <#symphony作業確認を対象としたrestapi>`__
`24 <#symphony作業確認を対象としたrestapi>`__

`5.3.1 リクエストの形式 <#リクエストの形式-7>`__
`24 <#リクエストの形式-7>`__

`5.3.2 レスポンスの項目 <#レスポンスの項目-1>`__
`24 <#レスポンスの項目-1>`__

`5.3.3 INFO <#info-3>`__ `24 <#info-3>`__

`5.4 Symphony作業一覧を対象としたRestAPI <#_Toc100580957>`__
`24 <#_Toc100580957>`__

`5.4.1 リクエストの形式 <#リクエストの形式-8>`__
`24 <#リクエストの形式-8>`__

`5.4.2 INFO <#info-4>`__ `24 <#info-4>`__

`5.4.3 FILTER・FILTER_DATAONLY <#filterfilter_dataonly-1>`__
`24 <#filterfilter_dataonly-1>`__

`5.4.4 EDIT <#edit-1>`__ `24 <#edit-1>`__

`5.4.5 DOWNLOAD <#download>`__ `24 <#download>`__

`6 Conductor利用編 <#conductor利用編>`__ `24 <#conductor利用編>`__

`6.1
Conductor登録作業を対象としたRestAPI <#conductor登録作業を対象としたrestapi>`__
`24 <#conductor登録作業を対象としたrestapi>`__

`6.1.1 リクエストの形式 <#リクエストの形式-9>`__
`24 <#リクエストの形式-9>`__

`6.1.2 INFO <#info-5>`__ `24 <#info-5>`__

`6.1.3 FILTER・FILTER_DATAONLY <#filterfilter_dataonly-2>`__
`24 <#filterfilter_dataonly-2>`__

`6.1.4 EDIT <#edit-2>`__ `24 <#edit-2>`__

`6.2
Conductor作業実行を対象としたRestAPI <#conductor作業実行を対象としたrestapi>`__
`24 <#conductor作業実行を対象としたrestapi>`__

`6.2.5 リクエストの形式 <#リクエストの形式-10>`__
`24 <#リクエストの形式-10>`__

`6.2.6 レスポンスの項目 <#レスポンスの項目-2>`__
`24 <#レスポンスの項目-2>`__

`6.2.7 EXECUTE <#execute-5>`__ `24 <#execute-5>`__

`6.2.8 CANCEL <#cancel-1>`__ `24 <#cancel-1>`__

`6.2.9 SCRAM <#scram-1>`__ `24 <#scram-1>`__

`6.2.10 RELEASE <#release-1>`__ `24 <#release-1>`__

`6.3
Conductor作業確認を対象としたRestAPI <#conductor作業確認を対象としたrestapi>`__
`24 <#conductor作業確認を対象としたrestapi>`__

`6.3.1 リクエストの形式 <#リクエストの形式-11>`__
`24 <#リクエストの形式-11>`__

`6.3.2 レスポンスの項目 <#レスポンスの項目-3>`__
`24 <#レスポンスの項目-3>`__

`6.3.3 INFO <#info-6>`__ `24 <#info-6>`__

`6.4
Conductor作業一覧を対象としたRestAPI <#conductor作業一覧を対象としたrestapi>`__
`24 <#conductor作業一覧を対象としたrestapi>`__

`6.4.4 リクエストの形式 <#リクエストの形式-12>`__
`24 <#リクエストの形式-12>`__

`6.4.5 INFO <#info-7>`__ `24 <#info-7>`__

`6.4.6 FILTER・FILTER_DATAONLY <#filterfilter_dataonly-3>`__
`24 <#filterfilter_dataonly-3>`__

`6.4.7 EDIT <#edit-3>`__ `24 <#edit-3>`__

`6.4.8 DOWNLOAD <#download-1>`__ `24 <#download-1>`__

`7 Movement利用編 <#movement利用編>`__ `24 <#movement利用編>`__

`7.1
Movement作業実行を対象としたRestAPI <#movement作業実行を対象としたrestapi>`__
`24 <#movement作業実行を対象としたrestapi>`__

`7.1.1 リクエストの形式 <#リクエストの形式-13>`__
`24 <#リクエストの形式-13>`__

`7.1.2 レスポンスの項目 <#レスポンスの項目-4>`__
`24 <#レスポンスの項目-4>`__

`7.1.3 EXECUTE <#execute-6>`__ `24 <#execute-6>`__

`7.1.4 CANCEL <#cancel-2>`__ `24 <#cancel-2>`__

`7.1.5 SCRAM <#scram-2>`__ `24 <#scram-2>`__

`8 バージョン確認 <#バージョン確認>`__ `24 <#バージョン確認>`__

`8.1
バージョン確認を対象としたRestAPI <#バージョン確認を対象としたrestapi>`__
`24 <#バージョン確認を対象としたrestapi>`__

`8.1.1 リクエストの形式 <#リクエストの形式-14>`__
`24 <#リクエストの形式-14>`__

`8.1.2 INFO <#info-8>`__ `24 <#info-8>`__

`9 比較実行 <#比較実行>`__ `24 <#比較実行>`__

`9.1 比較実行を対象としたRestAPI <#比較実行を対象としたrestapi>`__
`24 <#比較実行を対象としたrestapi>`__

`9.1.1 リクエストの形式 <#リクエストの形式-15>`__
`24 <#リクエストの形式-15>`__

`9.1.2 COMPARE <#compare>`__ `24 <#compare>`__

`10 付録 <#付録>`__ `24 <#付録>`__

`10.1 トラブルシューティング <#トラブルシューティング>`__
`24 <#トラブルシューティング>`__

はじめに
========

本書は、ITAシステムのRestAPIの概要および操作方法について説明します。

ITAシステム　REST APIの概要
===========================

本章ではITAを操作するための標準REST APIについて説明します。

REST APIについて
----------------

ITAでは、外部プログラムからITAで管理されているリソースに対して、各種操作を行うことが可能なREST
APIを提供しています。

-  以下の表に記載しているメニュー以外はすべて標準的なRESTAPIを使用できます。

..

   標準的なRESTAPIについて、『\ *2標準REST機能の利用*\ 』を参照

表 1‑1個別のREST API一覧

+----------------+--------------------+----------+--------------------+
| メ             | メニュー名         | メ       | 参照先             |
| ニューグループ |                    | ニューID |                    |
+================+====================+==========+====================+
| Symphony       | Symphonyクラス編集 | 21       | *5 Symphony利用編* |
|                |                    | 00000306 |                    |
+----------------+--------------------+----------+--------------------+
|                | Symphony作業実行   | 21       |                    |
|                |                    | 00000308 |                    |
+----------------+--------------------+----------+--------------------+
|                | Symphony作業確認   | 21       |                    |
|                |                    | 00000309 |                    |
+----------------+--------------------+----------+--------------------+
|                | Symphpny作業一覧   | 21       |                    |
|                |                    | 00000310 |                    |
+----------------+--------------------+----------+--------------------+
| Conductor      | C                  | 21       | *6                 |
|                | onductorクラス編集 | 00180003 | Conductor利用編*   |
+----------------+--------------------+----------+--------------------+
|                | Conductor作業実行  | 21       |                    |
|                |                    | 00180004 |                    |
+----------------+--------------------+----------+--------------------+
|                | Conductor作業確認  | 21       |                    |
|                |                    | 00180005 |                    |
+----------------+--------------------+----------+--------------------+
|                | Conductor作業一覧  | 21       |                    |
|                |                    | 00180006 |                    |
+----------------+--------------------+----------+--------------------+
| エクスポー     | メ                 | 21       | *3                 |
| ト/インポート  | ニューエクスポート | 00000211 | メ                 |
|                |                    |          | ニューエクスポート |
|                |                    |          | /インポート利用編* |
+----------------+--------------------+----------+--------------------+
|                | メニューインポート | 21       |                    |
|                |                    | 00000212 |                    |
+----------------+--------------------+----------+--------------------+
|                | Exc                | 21       | *4                 |
|                | el一括エクスポート | 00000329 | Exc                |
|                |                    |          | el一括エクスポート |
|                |                    |          | /インポート利用編* |
+----------------+--------------------+----------+--------------------+
|                | E                  | 21       |                    |
|                | xcel一括インポート | 00000330 |                    |
+----------------+--------------------+----------+--------------------+
| Ansible-Legacy | 作業実行           | 21       | *7 Movement利用編* |
|                |                    | 00020111 |                    |
+----------------+--------------------+----------+--------------------+
|                | 作業状態確認       | 21       |                    |
|                |                    | 00020112 |                    |
+----------------+--------------------+----------+--------------------+
| A              | 作業実行           | 21       |                    |
| nsible-Pioneer |                    | 00020211 |                    |
+----------------+--------------------+----------+--------------------+
|                | 作業状態確認       | 21       |                    |
|                |                    | 00020212 |                    |
+----------------+--------------------+----------+--------------------+
| Ansi           | 作業実行           | 21       |                    |
| ble-LegacyRole |                    | 00020312 |                    |
+----------------+--------------------+----------+--------------------+
|                | 作業状態確認       | 21       |                    |
|                |                    | 00020313 |                    |
+----------------+--------------------+----------+--------------------+
| Terraform      | 作業実行           | 21       |                    |
|                |                    | 00080009 |                    |
+----------------+--------------------+----------+--------------------+
|                | 作業状態確認       | 21       |                    |
|                |                    | 00080010 |                    |
+----------------+--------------------+----------+--------------------+
| 管理コンソール | バージョン確認     | 21       | *8 バージョン確認* |
|                |                    | 00000299 |                    |
+----------------+--------------------+----------+--------------------+
| 比較           | 比較実行           | 21       | *9*\ 比較実行      |
|                |                    | 00190003 |                    |
+----------------+--------------------+----------+--------------------+

表 1‑2 REST APIを利用できないメニュー覧

+----------------+----------------------------------------+------------+
| メ             | メニュー名                             | メニューID |
| ニューグループ |                                        |            |
+================+========================================+============+
| メニュー作成   | メニュー定義・作成                     | 2100160011 |
+----------------+----------------------------------------+------------+
| メニュー作成   | メニ                                   | 2100000205 |
|                | ュー作成実行（インストール時は非表示） |            |
+----------------+----------------------------------------+------------+
| 基本コンソール | ER図表示                               | 2100000326 |
+----------------+----------------------------------------+------------+
| Terraform      | 連携先Terraform管理                    | 2100080017 |
+----------------+----------------------------------------+------------+
| 管理コンソール | シーケンス管理                         | 2100000216 |
|                |                                        |            |
|                | （                                     |            |
|                | EDIT、UPLOAD_SPREADSHEETのみ利用不可） |            |
+----------------+----------------------------------------+------------+

標準REST機能の利用
==================

外部プログラムからREST
APIを利用して、ITAで管理されているリソースに対し、操作を行うことが可能です。以下に、呼び出し規約を示します。

リクエストの形式
----------------

ITAのREST
APIでは、ITA上の各メニューのパスに対してHTTPリクエストを発行します。

パス：

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=（各メニューのメニューID）

   例）[管理コンソール]-[システム設定]メニュー（メニューID：2100000202）の場合

   https://
   exastro-it-automation:443/default/menu/07_rest_api_ver1.php?no=2100000202

※<HostName>:ITAインストーラでインストールした時のホスト名『exastro-it-automation』

HTTPヘッダ：

   以下の表にあるものが利用可能です。

表 2‑1 HTTPヘッダパラメータ一覧

+-----------+----------------------------------------------------------+
| H         | 説明                                                     |
| TTPヘッダ |                                                          |
+===========+==========================================================+
| Host      | ITAのRestAPIサーバーのホスト名ま                         |
|           | たはIPアドレスとポート番号をコロン(:)区切りで指定する。  |
+-----------+----------------------------------------------------------+
| Con       | “application/json”を指定する。                           |
| tent-Type |                                                          |
|           | MethodがGETの場合は指定しなくてもよい。                  |
+-----------+----------------------------------------------------------+
| Auth      | ITAの認証要メニューにアクセスする場合は、                |
| orization |                                                          |
|           | 『ログインID』と『パスワード』\*                         |
|           | を、                                                     |
|           | 半角コロン(:)で結合して、base64encodeをした値、を指定。  |
|           |                                                          |
|           | MethodがGETの場合は指定しなくてもよい。                  |
+-----------+----------------------------------------------------------+
| X-Command | MethodがPOSTの場合のみに設定可能。                       |
|           |                                                          |
|           | 【INFO】、【FILTER】、【FILTER_DATAONLY】、【EDIT】      |
|           | のいずれかを設定できる。                                 |
+-----------+----------------------------------------------------------+

HTTPヘッダの文字列は大文字でも小文字でも問題ありません。

\* ITAのパスワードが期限切れとなっていた場合、RestAPIはErrorとなります。

Webシステムのログイン画面から、パスワードを変更してからリクエストを行ってください。

   但し、ActiveDirectory連携機能を利用している場合は、ActiveDirectory上で管理される認証情報に

   従います。（※ActiveDirectory連携機能の連携対象外ユーザーは、この限りではありません）

   **ActiveDirectory連携機能の詳細は、『利用手順マニュアル_管理コンソール』-『ActiveDirectory連携機能の利用』をご参照ください。**

HTTPヘッダの例：

   ログインIDが[test_loginid]で、パスワードが[test_password]の場合

test_loginid: test_password　を、base64encodeで暗号化

→[qTImqS9fo2qcozyxBaEyp3EspTSmp3qipzD=]）

Host:<HostName>:<Port>

Content-Type:application/json

Authorization: qTImqS9fo2qcozyxBaEyp3EspTSmp3qipzD=

X-Command: INFO

利用可能なメソッドとコマンド
----------------------------

HTTPリクエストメソッドは、原則POSTを指定してください。

例外として、ITAで認証不要と設定したメニューにアクセスする場合のみGETを指定できます。

利用可能なメソッドとコマンドの階層は以下のとおりです。

   Method

   　　　　　├GET ‐　①

   　　　　　｜

   　　　　　└POST

   (X-Command)｜

   ├【INFO】 ‐　②

   　　　　　　　├【FILTER】 ‐　③

   　　　　　　　├【FILTER_DATAONLY】 ‐　④

   　　　　　　　├【EDIT】 ‐　⑤

   　　　　　　　├【LIST_OPTIONS】 ‐　⑥

   ├【DOWNLOAD_SPREADSHEET】‐　⑦

   └【UPLOAD_SPREADSHEET】 ‐　⑧

GET（Method）
^^^^^^^^^^^^^

   列情報（列番号と列名）および、通常ステータス（廃止または活性中）の全レコードの行数とレコード内容を返却します。

   ・HTTPヘッダ　

   なし

   ・contentパラメータ

   なし

   ・レスポンス

   1)レコード行数

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{RECORD_LENGTH}の中に、

   数値として格納されます。

   2)列情報（列番号と列名）

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} -> キー{0}の中に、

   0から始まる数値を、キーとする配列として格納されます。

   表 2‑2レスポンスパラメータ一覧(列情報)

+------------------------------+---------------------------------------+
| 列番号                       | 列名                                  |
+==============================+=======================================+
| 0                            | 一列目                                |
+------------------------------+---------------------------------------+
| 1                            | 二列目                                |
+------------------------------+---------------------------------------+
|    …                         |    …                                  |
+------------------------------+---------------------------------------+

..

   3)レコード情報

   （JSON形式）（1行につき1個の配列（列番号と列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} -> キー{(1以降、

   該当レコードの存在行数を上限とする数値)}の中に、0から始まる数値をキーとする配列として格納されます。

   表 2‑3レスポンスパラメータ一覧(レコード情報)

+----------------------------+-----------------------------------------+
| 列番号                     | 列データ                                |
+============================+=========================================+
| 0                          | 一列目データ配列                        |
+----------------------------+-----------------------------------------+
| 1                          | 二列目データ配列                        |
+----------------------------+-----------------------------------------+
|    …                       |    …                                    |
+----------------------------+-----------------------------------------+

..

   Method：Getでレスポンスされるデータの表と、Jsonの階層構造を以下に示します。

   表 2‑4 返されるデータ一覧

+---------+-----------------+--------------------+--------------------+
|         | 0               | 1                  | 2                  |
+=========+=================+====================+====================+
| 0       | A               | I                  | U                  |
+---------+-----------------+--------------------+--------------------+
| 1       | あ              | い                 | う                 |
+---------+-----------------+--------------------+--------------------+
| 2       | か              | き                 | く                 |
+---------+-----------------+--------------------+--------------------+
| 3       | さ              | し                 | す                 |
+---------+-----------------+--------------------+--------------------+

+-----------------------------------------------------------------------+
| ▽JSON形式                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| "├RECORD_LENGTH": 3,                                                  |
|                                                                       |
| "└BODY": {                                                            |
|                                                                       |
| "0": [                                                                |
|                                                                       |
| "A",                                                                  |
|                                                                       |
| "I",                                                                  |
|                                                                       |
| "U"                                                                   |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "1": [                                                                |
|                                                                       |
| "あ",                                                                 |
|                                                                       |
| "い",                                                                 |
|                                                                       |
| "う"                                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "2": [                                                                |
|                                                                       |
| "か",                                                                 |
|                                                                       |
| "き",                                                                 |
|                                                                       |
| "く"                                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "3": [                                                                |
|                                                                       |
| "さ",                                                                 |
|                                                                       |
| "し",                                                                 |
|                                                                       |
| "す"                                                                  |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

INFO(X-Command)
^^^^^^^^^^^^^^^

   列情報のみを取得します。

   X-Command(FILTER、FILTER_DATAONLY)またはX-Command(EDIT)を実行する際に必要な情報を取得することができます。

   ・HTTPヘッダ

   表 2‑5 HTTPヘッダパラメータ一覧

+-----------------------+----------------------------------------------+
| HTTPヘッダ            | 値                                           |
+=======================+==============================================+
| X-Command             | INFO                                         |
+-----------------------+----------------------------------------------+

..

   ・contentパラメータ

   なし

   ・レスポンス

   1)列情報（列番号と列名）

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{INFO}の中に、

   0から始まる数値をキーとする配列として格納されます。

FILTER・FILTER_DATAONLY (X-Command)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

   パラメータで指定した条件に合致したレコードの、列情報（列番号と列名）および、

   通常ステータス（廃止または活性中）の全レコードの行数とレコード内容を返却します。

   FILTER_DATAONLYを指定した場合は、列情報を省略します。

表 2‑6 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | FILTER                              |
+--------------------------------+-------------------------------------+
|                                | FILTER_DATAONLY                     |
+--------------------------------+-------------------------------------+

..

   ・contentパラメータ

   1）フィルタ形式

   操作したいWebページの表示フィルタでフィルタをかけられる列と形式に従い、

   列ごとに以下をフィルタの種類として指定可能です。

   指定しない場合は全件検索となります。

   ・NORMAL ‐ 通常のLIKE検索

   ・RANGE ‐ 1~5等の範囲検索

   ・LIST ‐
   Webページの表示フィルタにプルダウンが表示されている列については、複数の完全一致条件によるOR検索。複数条件を配列に格納し指定可能

   ※GUI上番号範囲を指定するようなカラム（項番など）の場合、RANGEのSTARTのみ指定した検索とNORMALの検索は同様の検索結果となります。

   例）{"2":{"NORMAL":"1"}}

   {"2":{"RANGE":{"START":"1","END":""}}}

   .. image:: ./general_operations/image2.png
      :width: 2.35449in
      :height: 1.29185in

   2)指定形式

   JSON形式で指定。フィルタ種類ごとの形式で、フィルタ条件を格納します。

   JSON形式にする前段階では、１つの連想配列の中に、列番号ごとの連想配列を入れ子にする形で指定します。

   複数の列番号ごとの連想配列を格納した場合、ANDで繋いだ意味になります。

   さらに列番号ごとの連想配列の中にフィルタ条件の形式と条件をセットにした連想配列を格納してください。列番号ごとの連想配列に複数のフィルタ条件の連想配列を格納した場合、ORでつないだ意味になります。

   廃止状態を検索条件にする場合、NORMALで0（廃止含まず）か1(廃止のみ)を指定します。

   指定しない場合は廃止以外と廃止のすべてのレコードが取得されます。

   例) {"1":{"NORMAL":"0"}}

   廃止状態が「廃止含まず」のレコードを取得

   {"1":{"NORMAL":"1"}}

   廃止状態が「廃止のみ」のレコードを取得

   ・パラメータの記述例

+-----------------------------------------------------------------------+
| 　　例）　 FILTERパラメータの記述                                     |
+=======================================================================+
| 列番号2が列                                                           |
| 名【項番】(主キーのカラム列)、列番号4が【備考】のコンテンツの場合で、 |
|                                                                       |
| 　【項番】                                                            |
| が5以上かつ、【備考】に『あいう』が入っているレコードを抽出したい場合 |
|                                                                       |
| ↓抽出イメージ                                                         |
|                                                                       |
| +---------+-------------+-------------+-----------+--------------+    |
| |         | 列番号1     | 列番号2     | 列番号3   | 列番号4      |    |
| +=========+=============+=============+===========+==============+    |
| | 列名    | 【列名1】   | 【項番】    | 【列名3】 | 【備考】     |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 1       | \****\*     | 1           | \****\*   | あいうえお   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 2       | \****\*     | 2           | \****\*   | かきくけこ   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 3       | \****\*     | 3           | \****\*   | あいうえお   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 4       | \****\*     | 4           | \****\*   | かきくけこ   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 5       | \****\*     | 5           | \****\*   | かきくけこ   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| | 6       | \****\*     | 6           | \****\*   | あいうえお   |    |
| +---------+-------------+-------------+-----------+--------------+    |
| |    …    |    …        |    …        |    …      |    …         |    |
| +---------+-------------+-------------+-----------+--------------+    |
|                                                                       |
| ▽JSON形式                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "2": {                                                                |
|                                                                       |
| "RANGE": {                                                            |
|                                                                       |
| "START": 5                                                            |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "4": {                                                                |
|                                                                       |
| "'NORMAL": "あいう"                                                   |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| 例）　 FILTERパラメータの記述(2)                                      |
+=======================================================================+
| 列番号2が列名【項番】(主キーのカラム列)、のコンテンツの場合で、       |
|                                                                       |
| 　【項番】が10から99の                                                |
| 範囲、または、【項番】が1または2または5、のレコードを抽出したい場合。 |
|                                                                       |
| ↓抽出イメージ                                                         |
|                                                                       |
| +----------+--------------+-----------------------+--------------+    |
| |          | 列番号1      | 列番2                 | …            |    |
| +==========+==============+=======================+==============+    |
| | 列名     | 【列名１】   | 【項番】              | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 1        | \****\*      | 1                     | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 2        | \****\*      | 2                     | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 3        | \****\*      | 3                     | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 4        | \****\*      | 4                     | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 5        | \****\*      | 5                     | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| |    …     |    …         |    …                  | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 10       | \****\*      | 10                    | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| |    …     |    …         |    …                  | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| | 99       | \****\*      | 99                    | …            |    |
| +----------+--------------+-----------------------+--------------+    |
| |    …     |    …         |    …                  | …            |    |
| +----------+--------------+-----------------------+--------------+    |
|                                                                       |
| ▽JSON形式                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "2": {                                                                |
|                                                                       |
| "RANGE": {                                                            |
|                                                                       |
| "START": "10",                                                        |
|                                                                       |
| "END": "99"                                                           |
|                                                                       |
| },                                                                    |
|                                                                       |
| "LIST": [                                                             |
|                                                                       |
| "1",                                                                  |
|                                                                       |
| "2",                                                                  |
|                                                                       |
| "5"                                                                   |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| 例）　 FILTERパラメータの記述(3)                                      |
+=======================================================================+
| 列番号2が列名【項番】(主キーの                                        |
| カラム列)、列番号5が列名【最終更新日付】(日付型/日時型)のコンテンツの |
| 場合で、【項番】が1から100で、かつ、【最終更新日付】が2016年8月01日(  |
| 00:00:00)から2016年12月31日(23:59:59)の範囲のレコードを抽出したい場合 |
|                                                                       |
| ▽JSON形式                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "2": {                                                                |
|                                                                       |
| "RANGE": {                                                            |
|                                                                       |
| "START": "1",                                                         |
|                                                                       |
| "END": "100"                                                          |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "5": {                                                                |
|                                                                       |
| "RANGE": {                                                            |
|                                                                       |
| "START": "2016/08/01 00:00:00",                                       |
|                                                                       |
| "END": "2016/12/31 23:59:59"                                          |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   1)レコード行数

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{RECORD_LENGTH}の中に、

   数値として格納されます。

   2)列情報（列番号と列名）※FILTER指定時のみ

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} -> キー{0}の中に、

   0から始まる数値を、キーとする配列として格納される。

   表 2‑7 レスポンスパラメータ一覧(列情報)

+------------------------------+---------------------------------------+
| 列番号                       | 列名                                  |
+==============================+=======================================+
| 0                            | 一列目                                |
+------------------------------+---------------------------------------+
| 1                            | 二列目                                |
+------------------------------+---------------------------------------+
|    …                         |    …                                  |
+------------------------------+---------------------------------------+

..

   3)レコード情報

   （JSON形式）（1行につき1個の配列（列番号と列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
   キー{(1以降、該当レコードの存在行数を上限とする数値)}の中に、0から始まる数値をキーとする配列として格納される。

   表 2‑8 レスポンスパラメータ一覧(レコード情報)

+-----------------+-------------------------+--------------------------+
| 列番号          | 列データ                | 説明                     |
+=================+=========================+==========================+
| 0               | 一列目データ            |                          |
+-----------------+-------------------------+--------------------------+
| 1               | 二列目データ            |                          |
+-----------------+-------------------------+--------------------------+
|    …            |    …                    |                          |
+-----------------+-------------------------+--------------------------+

..

   ※Json格納時の階層構造は、Method:GETと同様です。

   アクセス許可ロールの検索方法については『Exastro-ITA_利用手順マニュアル_データレコード毎のロールベースアクセス制御』をご参照ください。

EDIT(X-Command)
^^^^^^^^^^^^^^^

   レコードの登録、既存レコードの更新、廃止、復活を行います。

   ・HTTPヘッダ

   表 2‑9 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | EDIT                                |
+--------------------------------+-------------------------------------+

..

   ・パラメータ

   1)指定形式

   JSON形式で指定してください。

   INFOで取得できる列情報をもとに、１レコードにつき１つの配列で指定し、１レコードを

   格納した配列を要素とする配列を、JSON形式でエンコードしたものをHTTPリクエスト

   のcontextとして送信してください。

   | [更新]時は、必須項目であってもパラメータを省略した場合、値を変更せずに更新実行
   | します。ただし、データを特定する一意項目(ID、No等)は省略できません。

   列番号0の列名【処理種別】には、[登録]、[更新]、[廃止]、[復活]のいずれかを

   指定してください。

+-----------------------------------------------------------------------+
| **　　例(1) 　登録　**                                                |
+=======================================================================+
| | 　列番号0が列名【                                                   |
| 処理種別】、列番1が【廃止】、列番号2が【項番】(主キー役のカラム列)、  |
| | 　・・・（中略）・・・                                              |
| | 　列番号10が【備考】、列番号11が【最終更新日時】、列番号12が【更新  |
| 用の最終更新日時】、列番号13が【最終更新者】、のコンテンツの場合に、  |
| | 　2レコードを追加する場合、                                         |
| | ▽JSON形式                                                           |
|                                                                       |
| {                                                                     |
|                                                                       |
| "0": {                                                                |
|                                                                       |
| "0": "登録",                                                          |
|                                                                       |
| "1": "",                                                              |
|                                                                       |
| "2": "",                                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| "10": "備考",                                                         |
|                                                                       |
| "11": "",                                                             |
|                                                                       |
| "12": "",                                                             |
|                                                                       |
| "13": ""                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "1": {                                                                |
|                                                                       |
| "0": "登録",                                                          |
|                                                                       |
| "1": "",                                                              |
|                                                                       |
| "2": "",                                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| "10": "備考",                                                         |
|                                                                       |
| "11": "",                                                             |
|                                                                       |
| "12": "",                                                             |
|                                                                       |
| "13": ""                                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| **　　例(2) 　更新　**                                                |
+=======================================================================+
| | 　列番号0が列名【処                                                 |
| 理種別】、列番号1が【廃止】、列番号2が【項番】(主キー役のカラム列)、  |
| | 　・・・（中略）・・・                                              |
| | 　列番号9が【備考】、列番号10が【最終更新日時】、                   |
| | 　列番号11が【更新                                                  |
| 用の最終更新日時】、列番号12が【最終更新者】、のコンテンツの場合に、  |
| | 　【項番】10のレコードを更新する場合、                              |
| | ▽JSON形式                                                           |
| | {                                                                   |
|                                                                       |
| "0":{                                                                 |
|                                                                       |
| "0": "更新",                                                          |
|                                                                       |
| "1": "",                                                              |
|                                                                       |
| "2": "10",                                                            |
|                                                                       |
| "9": "備考欄",                                                        |
|                                                                       |
| "10": "2016/08/01 12:30:45",                                          |
|                                                                       |
| "11": "【更新用の最終更新日時】",※                                    |
|                                                                       |
| "12": "管理者"                                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ※Method：GET、X-Command：FILTERで取得した、【更新用の最終更新日時】をセット

   してください。このデータによって、追い越し更新を防止しています。

   【更新用の最終更新日時】は、“\ *T*\ \_“で始まっています。

+-----------------------------------------------------------------------+
| **　　例(3) 　登録（ファイルアップロードあり）**                      |
+=======================================================================+
| | 　列番号0が列名【処理種別】、列番1が                                |
| 【廃止】、列番号2が【項番】(主キー役のカラム列)、・・・（中略）・・・ |
| | 　列番号5が【備考】、列番号6が【最終更新日時】、列番号7が【更       |
| 新用の最終更新日時】、列番号8が【最終更新者】、のコンテンツの場合に、 |
|                                                                       |
| ▽JSON形式                                                             |
|                                                                       |
| ・　1レコードを追加する場合、ファイルのアップロードあり               |
|                                                                       |
| {                                                                     |
|                                                                       |
| "0": {                                                                |
|                                                                       |
| "0": "登録",                                                          |
|                                                                       |
| "3": "PV05004",                                                       |
|                                                                       |
| "4": "20191226095004.yml",                                            |
|                                                                       |
| "5": "TEST"                                                           |
|                                                                       |
| },                                                                    |
|                                                                       |
| "UPLOAD_FILE": [                                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| "4": "<対象ファイルをbase64encodeをした値>"                           |
|                                                                       |
| }                                                                     |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| | ・　2レコードを追加する場合、ファイルのアップロードあり             |
| | {                                                                   |
|                                                                       |
| "0": {                                                                |
|                                                                       |
| "0": "登録",                                                          |
|                                                                       |
| "3": "PV05004",                                                       |
|                                                                       |
| "4": "20191226095004.yml",                                            |
|                                                                       |
| "5": "TEST"                                                           |
|                                                                       |
| },                                                                    |
|                                                                       |
| "1": {                                                                |
|                                                                       |
| "0": "登録",                                                          |
|                                                                       |
| "3": "PV15004",                                                       |
|                                                                       |
| "4": "20191226095004.yml",                                            |
|                                                                       |
| "5": "TEST"                                                           |
|                                                                       |
| },                                                                    |
|                                                                       |
| "UPLOAD_FILE": [                                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| "4": "<対象ファイルをbase64encodeした値>"                             |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| "4": "<対象ファイルをbase64encodeした値>"                             |
|                                                                       |
| }                                                                     |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ※UPLOAD_FILEについて、対象ファイルをbase64encodeした値を指定し、ファイルのアップロードを行います。

   ※ファイルをアップロードする場合、要素順に『UPLOAD_FILE』に追加します。

   ※ファイルアップロード時の最大ファイルサイズの上限を変更する場合は、PHPの設定を変更する必要があります。変更する項目について、『
   **10.1トラブルシューティング**\ 』を参照してください。デフォルト値については、別紙『【参考】インストール時の各コンフィグ設定値』を参照してください。

+-----------------------------------------------------------------------+
| **　　例(4) 　更新（ファイル削除）**                                  |
+=======================================================================+
| | 　列番号0が列名【処                                                 |
| 理種別】、列番号1が【廃止】、列番号2が【項番】(主キー役のカラム列)、  |
| | 　・・・（中略）・・・                                              |
| |                                                                     |
| 　列番号4が【ファイルアップロード項目】、列番号10が【最終更新日時】、 |
| | 　列番号11が【更新                                                  |
| 用の最終更新日時】、列番号12が【最終更新者】、のコンテンツの場合に、  |
| | 　【項番】10のレコードを更新する場合、                              |
| | ▽JSON形式                                                           |
| | {                                                                   |
|                                                                       |
| "0":{                                                                 |
|                                                                       |
| "0": "更新",                                                          |
|                                                                       |
| "1": "",                                                              |
|                                                                       |
| "2": "10",                                                            |
|                                                                       |
| "3": "PV05005",                                                       |
|                                                                       |
| "4": "",                                                              |
|                                                                       |
| "5": "TEST"                                                           |
|                                                                       |
| "10": "2016/08/01 12:30:45",                                          |
|                                                                       |
| "11": "【更新用の最終更新日時】",※                                    |
|                                                                       |
| "12": "管理者"                                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ※ファイルを削除する場合、「UPLOAD_FILE」を使用せず、対象ファイル名を空文字としてパラメータに設定してください。

   ・レスポンス

   1)各レコードの処理結果

   （JSON形式）

   キー{resultdata} -> キー{LIST} -> キー{NORMAL} ->
   キー{register、update、

   delete、error}の中に、配列として格納されます。

   表 2‑10 Keyパラメータ一覧

+--------------+--------------+----------------------------------------+
| **key**      | **値の型**   | **　**                                 |
+==============+==============+========================================+
| name         | 文字列       | 処理結果種類の名前                     |
+--------------+--------------+----------------------------------------+
| ct           | 数値         | （処理結果ごとの）レコード件数         |
+--------------+--------------+----------------------------------------+

..

   2)各レコードの処理結果

   （JSON形式）

   キー{resultdata} -> キー{LIST} -> キー{RAW} ->
   キー{パラメータとして渡した

   レコード番号（列情報を送信しなくてよい）デフォルト設定では、0、から始まる）}の中に、

   0から始まる数値を、キーとする配列として格納されます。

   表 2‑11 Keyパラメータ一覧

+--------------+--------------+----------------------------------------+
| **key**      | **値の型**   | **　**                                 |
+==============+==============+========================================+
| 0            | 文字列       | 結果コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 1            | 文字列       | 詳細コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 2            | 文字列       | エラーメッセージ                       |
+--------------+--------------+----------------------------------------+

..

   ・レスポンス結果階層表

   resultdata

   └LIST

   ├NORMAL

   ｜ ├register: {name:,ct:}

   ｜ ├update:　{name:,ct:}

   ｜ ├delete:　 {name:,ct:}

   ｜ └error: {name:,ct:}

   ｜

   └RAW

   ├0:{0:,1:,2:}

   ├1: {0:,1:,2:}

   ├2: {0:,1:,2:}

   ├　・

   ├　・

   ・

・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "LIST": {                                                             |
|                                                                       |
| "NORMAL": {                                                           |
|                                                                       |
| "register": {                                                         |
|                                                                       |
| "name": "登録",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "update": {                                                           |
|                                                                       |
| "name": "更新",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "delete": {                                                           |
|                                                                       |
| "name": "廃止",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "revive": {                                                           |
|                                                                       |
| "name": "復活",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "error": {                                                            |
|                                                                       |
| "name": "エラー",                                                     |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "RAW": [                                                              |
|                                                                       |
| [                                                                     |
|                                                                       |
| ・・・別表：結果コード／詳細コード　一覧・・・                        |
|                                                                       |
| ],                                                                    |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   別表：結果コード／詳細コード　一覧

+------+------+------+-----------------------------------------------+
| 処理 | 結   | 詳   | 説明                                          |
| 種別 | 果コ | 細コ |                                               |
|      | ード | ード |                                               |
+======+======+======+===============================================+
| 登録 | 000  | 201  | 登録の成功。                                  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 必須項目が未入力。                            |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | レコードと重複している項目がある。            |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 重                                            |
|      |      |      | 複禁止に違反しているレコードが存在している。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力値の長さが規定のバイト数を超えている。    |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力値[NULLバイト文字等が含まれた値]が不正。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 半角整数以外が入力された。                    |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 値が範囲外。                                  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力された値が                                |
|      |      |      | 最小値を下回っているか最大値を上回っている。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力条件を満たしていない。                    |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 数値以外が入力された。                        |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | タブと改行が入力された。                      |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | タブが入力された。                            |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力値が範囲外。                              |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 入力値が、                                    |
|      |      |      | PHP関数(checkdate)で正常に処理できる範囲外。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 利用できない値が選択された。                  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | 登                                            |
|      |      |      | 録時に指定できない項目(主キー)が指定された。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | フ                                            |
|      |      |      | ァイル名の指定はあるが、ファイルの値がない。  |
+------+------+------+-----------------------------------------------+
| 登録 | 002  | 000  | フ                                            |
|      |      |      | ァイルの値はあるが、ファイル名の指定がない。  |
+------+------+------+-----------------------------------------------+
| 登録 | -    | -    | メンテナンス権限がない。                      |
+------+------+------+-----------------------------------------------+
| 登録 | -    | -    | JSONパラメータの形式が不正。                  |
+------+------+------+-----------------------------------------------+
| 更新 | 000  | 200  | 更新の成功。                                  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 必須項目が未入力。                            |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | レコードと重複している項目がある。            |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 重                                            |
|      |      |      | 複禁止に違反しているレコードが存在している。  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力値の長さが規定のバイト数を超えている。    |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力値[NULLバイト文字等が含まれた値]が不正。  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 半角整数以外が入力された。                    |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 値が範囲外。                                  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力された値が                                |
|      |      |      | 最小値を下回っているか最大値を上回っている。  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力条件を満たしていない。                    |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 数値以外が入力された。                        |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | タブと改行が入力された。                      |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | タブが入力された。                            |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力値が範囲外。                              |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 入力値が、                                    |
|      |      |      | PHP関数(checkdate)で正常に処理できる範囲外。  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | 利用できない値が選択された。                  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | フ                                            |
|      |      |      | ァイル名の指定はあるが、ファイルの値がない。  |
+------+------+------+-----------------------------------------------+
| 更新 | 002  | 000  | フ                                            |
|      |      |      | ァイルの値はあるが、ファイル名の指定がない。  |
+------+------+------+-----------------------------------------------+
| 更新 | 003  | 000  | 別セッションからレコー                        |
|      |      |      | ドが更新されたため、更新の実行が中止された。  |
+------+------+------+-----------------------------------------------+
| 更新 | 003  | 000  | 廃止済レコードへの更新が実行されようとした。  |
+------+------+------+-----------------------------------------------+
| 更新 | 101  | 000  | 更新対象の行が特定できなかった。              |
+------+------+------+-----------------------------------------------+
| 更新 | -    | -    | メンテナンス権限がない。                      |
+------+------+------+-----------------------------------------------+
| 更新 | -    | -    | JSONパラメータの形式が不正。                  |
+------+------+------+-----------------------------------------------+
| 廃止 | 000  | 210  | 廃止の成功。                                  |
+------+------+------+-----------------------------------------------+
| 廃止 | 002  | 000  | 入力値の長さが規定のバイト数を超えている。    |
+------+------+------+-----------------------------------------------+
| 廃止 | 002  | 000  | 入力値[NULLバイト文字等が含まれた値]が不正。  |
+------+------+------+-----------------------------------------------+
| 廃止 | 002  | 000  | 入力された値が                                |
|      |      |      | 最小値を下回っているか最大値を上回っている。  |
+------+------+------+-----------------------------------------------+
| 廃止 | 002  | 000  | 入力条件を満たしていない。                    |
+------+------+------+-----------------------------------------------+
| 廃止 | 002  | 000  | タブが入力された。                            |
+------+------+------+-----------------------------------------------+
| 処理 | 結   | 詳   | 説明                                          |
| 種別 | 果コ | 細コ |                                               |
|      | ード | ード |                                               |
+------+------+------+-----------------------------------------------+
| 廃止 | 003  | 000  | 別セッションからレコー                        |
|      |      |      | ドが更新されたため、廃止の実行が中止された。  |
+------+------+------+-----------------------------------------------+
| 廃止 | 003  | 000  | 廃止済レコードへの廃止が実行されようとした。  |
+------+------+------+-----------------------------------------------+
| 廃止 | 101  | 000  | 廃止対象の行が特定できなかった。              |
+------+------+------+-----------------------------------------------+
| 廃止 | -    | -    | メンテナンス権限がない。                      |
+------+------+------+-----------------------------------------------+
| 廃止 | -    | -    | JSONパラメータの形式が不正。                  |
+------+------+------+-----------------------------------------------+
| 復活 | 000  | 200  | 復活の成功。                                  |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 必須項目が未入力。                            |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 復活の                                        |
|      |      |      | 場合、更新できない項目が更新されようとした。  |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | レコードと重複している項目がある。            |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 重                                            |
|      |      |      | 複禁止に違反しているレコードが存在している。  |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 入力値の長さが規定のバイト数を超えている。    |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 入力値[NULLバイト文字等が含まれた値]が不正。  |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 入力された値が                                |
|      |      |      | 最小値を下回っているか最大値を上回っている。  |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | 入力条件を満たしていない。                    |
+------+------+------+-----------------------------------------------+
| 復活 | 002  | 000  | タブが入力された。                            |
+------+------+------+-----------------------------------------------+
| 復活 | 003  | 000  | 別セッションからレコー                        |
|      |      |      | ドが更新されたため、復活の実行が中止された。  |
+------+------+------+-----------------------------------------------+
| 復活 | 003  | 000  | 復活済レコードへの復活が実行されようとした。  |
+------+------+------+-----------------------------------------------+
| 復活 | 101  | 000  | 復活対象の行が特定できなかった。              |
+------+------+------+-----------------------------------------------+
| 復活 | -    | -    | メンテナンス権限がない。                      |
+------+------+------+-----------------------------------------------+
| 復活 | -    | -    | JSONパラメータの形式が不正。                  |
+------+------+------+-----------------------------------------------+
| 表示 | -    | -    | バリデーションエラー。                        |
+------+------+------+-----------------------------------------------+
| 表示 |      |      | JSONパラメータの形式が不正。                  |
+------+------+------+-----------------------------------------------+
| 表示 | -    | -    | 次のいずれか(全レコ                           |
|      |      |      | ード,廃止含まず,廃止のみ)が選択されていない。 |
+------+------+------+-----------------------------------------------+
| -    | 000  | 000  | 処理スキップして、次のレコードへ。            |
+------+------+------+-----------------------------------------------+

LIST_OPTIONS(X-Command)
^^^^^^^^^^^^^^^^^^^^^^^

   各メニューのプルダウン項目で選択可能な値の一覧を取得します。

   ※アクセス権/アクセス許可ロールの選択可能な値は取得されません。

表 2‑12 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | LIST_OPTIONS                        |
+--------------------------------+-------------------------------------+

..

   ・レスポンス

   1)列情報（列番号と列名）

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} -> キー{0}の中に、

   0から始まる数値を、キーとする配列として格納されます。

   表 2‑13 レスポンスパラメータ一覧(列情報)

+------------------------------+---------------------------------------+
| 列番号                       | 列名                                  |
+==============================+=======================================+
| 0                            | 一列目                                |
+------------------------------+---------------------------------------+
| 1                            | 二列目                                |
+------------------------------+---------------------------------------+
|    …                         |    …                                  |
+------------------------------+---------------------------------------+

..

   2)レコード情報

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
   キー{1}の中に、配列として格納されます。

   プルダウン項目のみデータが取得され、それ以外の項目は空で取得されます。

   表 2‑14 レスポンスパラメータ一覧(レコード情報)

+-----------------+-------------------------+--------------------------+
| 列番号          | 列データ                | 説明                     |
+=================+=========================+==========================+
| 0               | 一列目データ            |                          |
+-----------------+-------------------------+--------------------------+
| 1               | 二列目データ            |                          |
+-----------------+-------------------------+--------------------------+
|    …            |    …                    |                          |
+-----------------+-------------------------+--------------------------+

..

   ・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| "BODY": {                                                             |
|                                                                       |
| 0: {                                                                  |
|                                                                       |
| 0:"実行処理種別"                                                      |
|                                                                       |
| 1:・・・                                                              |
|                                                                       |
| 2:・・・                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| 1: {                                                                  |
|                                                                       |
| 0:{                                                                   |
|                                                                       |
| 0:"登録”                                                              |
|                                                                       |
| 1:"更新”                                                              |
|                                                                       |
| 2:"廃止”                                                              |
|                                                                       |
| 3:"復活”                                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| 1:{プルダウン項目の場合は一覧表示、それ以外は空}                      |
|                                                                       |
| ・・・                                                                |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

DOWNLOAD_SPREADSHEET(X-Command)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

   各メニューを、フィルタをかけた状態でEXCELダウンロードします。EXCEL出力最大行数を超えている場合は、SCSVファイルをダウンロードします。

   パラメータの指定方法はFILTERと同様です。

表 2‑15 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | DOWNLOAD_SPREADSHEET                |
+--------------------------------+-------------------------------------+

..

   ・レスポンス

   1)レコード情報

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY}
   の中に、配列として格納されます。

   表 2‑16 レスポンスパラメータ一覧(列情報)

+------------------------------+---------------------------------------+
| 列キー名                     | 列名                                  |
+==============================+=======================================+
| FILE_NAME                    | ダウンロードファイル名                |
+------------------------------+---------------------------------------+
| FILE_TYPE                    | ファイル拡張子の種類                  |
|                              |                                       |
|                              | （EXCELまたはSCSV）                   |
+------------------------------+---------------------------------------+

2)ファイル情報

（JSON形式）

   キー{resultdata} -> キー{CONTENTS} -> キー{DOWNLOAD_FILE}
   の中に格納されます。

**表 2-17** **レスポンスパラメータ一覧**

+-------------------------------+---------------------------------------+
|    列キー名                   |    列名                               |
+===============================+=======================================+
| DOWNLOAD_FILE                 | ダウンロー                            |
|                               | ドファイルをBASE64でエンコードした値  |
+-------------------------------+---------------------------------------+

..

   ・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| "BODY": {                                                             |
|                                                                       |
| "FILE_NAME":ダウンロードファイル名                                    |
|                                                                       |
| "FILE_TYPE":"EXCEL"または"SCSV"                                       |
|                                                                       |
| }                                                                     |
|                                                                       |
| "DOWNLOAD_FILE":ダウンロードファイルをBASE64でエンコードした値        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

UPLOAD_SPREADSHEET(X-Command)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

   各メニューの登録・更新用EXCELファイル（またはSCSVファイル）をREST
   APIでアップロードします。

表 2‑18 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | UPLOAD_SPREADSHEET                  |
+--------------------------------+-------------------------------------+

+-----------------------------------------------------------------------+
| UPLOAD\_ SPREADSHEET　Json記述例                                      |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "FILE_NAME":アップロードファイル名                                    |
|                                                                       |
| "UPLOAD_FILE":アップロードファイルをBASE64でエンコードした値          |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   1)各レコードの処理結果

   （JSON形式）

   キー{resultdata} -> キー{LIST} -> キー{NORMAL} ->
   キー{register、update、

   delete、error}の中に、配列として格納されます。

   表 2‑19 Keyパラメータ一覧

+--------------+--------------+----------------------------------------+
| **key**      | **値の型**   | **　**                                 |
+==============+==============+========================================+
| name         | 文字列       | 処理結果種類の名前                     |
+--------------+--------------+----------------------------------------+
| ct           | 数値         | （処理結果ごとの）レコード件数         |
+--------------+--------------+----------------------------------------+

..

   2)各レコードの処理結果

   （JSON形式）

   エラー情報（該当項目、エラー内容）がキー{resultdata} -> キー{LIST} ->
   キー{ERROR_DETAIL}
   の中に、WebからEXCELファイル（またはSCSVファイル）をアップロードしてエラーが発生した時に出力されるファイル（tableIUDByExcel_exec_YYYYMMDDhhmmss_nnnnnnnnn.log）と同様のエラー内容が行数分配列として格納されます。

   表 2‑20 レスポンスパラメータ一覧(レコード情報)

+-----------------+-------------------------+--------------------------+
| 列番号          | 列データ                | 説明                     |
+=================+=========================+==========================+
| 0               | 一列目データ            |                          |
+-----------------+-------------------------+--------------------------+
| 1               | 二列目データ            |                          |
+-----------------+-------------------------+--------------------------+
|    …            |    …                    |                          |
+-----------------+-------------------------+--------------------------+

・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "LIST": {                                                             |
|                                                                       |
| "NORMAL": {                                                           |
|                                                                       |
| "register": {                                                         |
|                                                                       |
| "name": "登録",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "update": {                                                           |
|                                                                       |
| "name": "更新",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "delete": {                                                           |
|                                                                       |
| "name": "廃止",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "revive": {                                                           |
|                                                                       |
| "name": "復活",                                                       |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "error": {                                                            |
|                                                                       |
| "name": "エラー",                                                     |
|                                                                       |
| "ct":                                                                 |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "ERROR_DETAIL": [                                                     |
|                                                                       |
| 10行目 MovementID1                                                    |
|                                                                       |
| 更新                                                                  |
| 別セ                                                                  |
| ッションからレコードが更新されたため、処理を中止しました。(操作:更新) |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

　　

メニューエクスポート/インポート利用編
=====================================

メニューエクスポートを対象としたRestAPI
---------------------------------------

   メニューエクスポートの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[エクスポート/インポート]の、[メニューエクスポート]メニューに相当する操作です。

表 3‑1 メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| エ                    | メニューエクスポート     | 2100000211       |
| クスポート/インポート |                          |                  |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-1:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   3‑3　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 3‑2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | EXECUTE                                                 |
|            |                                                         |
|            | INFO                                                    |
|            |                                                         |
|            | の2つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

**表 3‑3　X-Commandに指定可能なパラメータ一覧**

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| INFO     | エクスポート可能な            | メニュー      | 21       |
|          | メニューの一覧を取得します。  | エクスポート  | 00000211 |
+----------+-------------------------------+---------------+----------+
| EXECUTE  | エクスポートを実行します。    | メニュー      | 21       |
|          |                               | エクスポート  | 00000211 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

INFO
~~~~

   エクスポート可能なメニューの一覧を出力します。

   ・パラメータ

   　指定するパラメータはありません。

   　・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "MENU_LIST": {                                                        |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| "menu_group_name": "メニューグループ名",                              |
|                                                                       |
| "menu": [                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "menu_id": "メニューID ",                                             |
|                                                                       |
| "menu_name": "メニュー名"                                             |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| ]                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

表 3‑4　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| メニューグループID   | メニューグループ                              |
|                      | IDをキーとしてメニューの\ **配列を構成する**  |
+----------------------+-----------------------------------------------+
| menu_group_name      | メニューグループ名                            |
+----------------------+-----------------------------------------------+
| menu_id              | メニューID                                    |
+----------------------+-----------------------------------------------+
| menu_name            | メニュー名                                    |
+----------------------+-----------------------------------------------+

EXECUTE
~~~~~~~

   対象のメニューを指定し、エクスポートを実行します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

**表 3‑5 メニューエクスポートパラメータ一覧**

+------------------------------+---------------------------------------+
| パラメータ名                 | 設定値                                |
+==============================+=======================================+
| メニューグループID           | メニューID                            |
+------------------------------+---------------------------------------+
| dp_mode                      | モード                                |
|                              |                                       |
|                              | 1:環境移行                            |
|                              |                                       |
|                              | 2:時刻指定                            |
+------------------------------+---------------------------------------+
| abolished_type               | 廃止情報                              |
|                              |                                       |
|                              | 1:廃止を含む                          |
|                              |                                       |
|                              | 2:廃止を除く                          |
+------------------------------+---------------------------------------+
| specified_timestamp          | 指定時刻                              |
|                              |                                       |
|                              | モードで2.時                          |
|                              | 刻指定を指定するときのみ入力します。  |
|                              |                                       |
|                              | YYYY-MM-DD H:i型で指定してください    |
|                              |                                       |
|                              | 例：2020-01-01 00:00                  |
+------------------------------+---------------------------------------+

..

   ※メニューグループID、メニューIDは、INFOの返り値で取得したものです。

+-----------------------------------------------------------------------+
| **例）JSON記述**                                                      |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "2100000002": [                                                       |
|                                                                       |
| 2100000202,                                                           |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| 2100000222                                                            |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "2100000003": [                                                       |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| “dp_mode”: “2”,                                                       |
|                                                                       |
| “abolished_type”: “1”,                                                |
|                                                                       |
| “specified_timestamp”:” 2020-01-01 00:00”                             |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "TASK_ID": "実行No ",                                                 |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

表 3‑6　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| TASK_ID              | 作業No                                        |
|                      |                                               |
|                      | 作業Noで[メ                                   |
|                      | ニューエクスポート・インポート管理]メニューを |
|                      | 検索することにより、実行状況を確認できます。  |
+----------------------+-----------------------------------------------+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：正常終了                              |
|                      |                                               |
|                      |    002：実行不可                              |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+

メニューインポートを対象としたRestAPI
-------------------------------------

   メニューエクスポートの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[エクスポート/インポート]の、[メニューインポート]メニューに相当する操作です。

表 3‑7 メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| エ                    | メニューインポート       | 2100000212       |
| クスポート/インポート |                          |                  |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-2:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表 3‑9
   X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

**表 3‑8　HTTPヘッダパラメータ一覧**

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | UPLOAD                                                  |
|            |                                                         |
|            | EXECUTE                                                 |
|            |                                                         |
|            | の2つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 3‑9 X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| UPLOAD   | エクスポー                    | メニュ        | 21       |
|          | トしたkymファイルのアップロー | ーインポート  | 00000212 |
|          | ドを実施し、インポート可能な  |               |          |
|          | メニューリストを出力します。  |               |          |
+----------+-------------------------------+---------------+----------+
| EXECUTE  | インポート対象のメニューを選  | メニュ        | 21       |
|          | 択し、インポートを実施する。  | ーインポート  | 00000212 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

UPLOAD
~~~~~~

   エクスポートされたファイルのアップロードを実行します。

   ファイルはbase64encodeしたものをパラメータとして転送します。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

   **表 3‑10　メニューインポートUPLOADパラメータ一覧**

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| name                 | 対象のファイル名                              |
+----------------------+-----------------------------------------------+
| base64               | 対象のファイルをbase64encodeした値を指定      |
+----------------------+-----------------------------------------------+

+-----------------------------------------------------------------------+
| 1）UPLOAD　Json記述例                                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "zipfile":{                                                           |
|                                                                       |
| "name":"ita_exportdata_20191224092830.kym",                           |
|                                                                       |
| "base64":"・・・中略・・・"                                           |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": ""SUCCEED",                                                 |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "upload_id": "アップロードID ",※                                      |
|                                                                       |
| "data_portability_upload_file_name": "ファイル名",                    |
|                                                                       |
| “dp_mode”: “1”,                                                       |
|                                                                       |
| “abolished_type”: “1”,                                                |
|                                                                       |
| "specified_timestamp":null,                                           |
|                                                                       |
| "IMPORT_LIST": {                                                      |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| "menu_group_name": "メニューグループ名",                              |
|                                                                       |
| "menu": [                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "menu_id": "メニューID ",                                             |
|                                                                       |
| "menu_name": "メニュー名"                                             |
|                                                                       |
| }                                                                     |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ※『upload_id』インポートの操作（EXECUTE）する際に使用します。

表 3‑11　レスポンス項目一覧

+-------------------------------+--------------------------------------+
| 項目名                        | 備考                                 |
+===============================+======================================+
| upload_id                     | アップロード成功時に付与される値     |
|                               |                                      |
|                               | EXECUTE時に使用                      |
+-------------------------------+--------------------------------------+
| data                          | ファイル名                           |
| _portability_upload_file_name |                                      |
+-------------------------------+--------------------------------------+
| dp_mode                       | モード                               |
|                               |                                      |
|                               | 1:環境移行                           |
|                               |                                      |
|                               | 2:時刻指定                           |
+-------------------------------+--------------------------------------+
| abolished_type                | 廃止情報                             |
|                               |                                      |
|                               | 1:廃止を含む                         |
|                               |                                      |
|                               | 2:廃止を除く                         |
+-------------------------------+--------------------------------------+
| specified_timestamp           | 指定時刻                             |
|                               |                                      |
|                               | dp                                   |
|                               | _modeが1の場合はnullが設定されます。 |
+-------------------------------+--------------------------------------+
| メニューグループID            | メニューグループID                   |
|                               | をキーとしてメニューの配列を構成する |
+-------------------------------+--------------------------------------+
| menu_group_name               | メニューグループ名                   |
+-------------------------------+--------------------------------------+
| menu_id                       | メニューID                           |
+-------------------------------+--------------------------------------+
| menu_name                     | メニュー名                           |
+-------------------------------+--------------------------------------+
| RESULTCODE                    | コマンド実行の成否のコード           |
|                               |                                      |
|                               |    000：正常終了                     |
|                               |                                      |
|                               |    002：実行不可                     |
+-------------------------------+--------------------------------------+
| RESULTINFO                    | 詳細情報                             |
+-------------------------------+--------------------------------------+

.. _execute-1:

EXECUTE
~~~~~~~

   アップロードしたファイルを元に、インポート処理を実行します。

   対象とする、メニューグループ、メニューID、インポート実行モードを指定できます。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

**表 3‑12** **メニューインポートEXECUTEパラメータ**

+--------------------------+-----------+-------------------------------+
| パラメータ名             | 設定値    | 備考                          |
+==========================+===========+===============================+
| メニューグループID       | メ        |                               |
|                          | ニューID  |                               |
+--------------------------+-----------+-------------------------------+
| upload_id                |           | UPLOADの返り値で取得した      |
|                          |           | ものの先頭に”A_”を付与した値  |
+--------------------------+-----------+-------------------------------+
| data_port                | フ        |                               |
| ability_upload_file_name | ァイル名  |                               |
+--------------------------+-----------+-------------------------------+

+-----------------------------------------------------------------------+
| 1）EXECUTE　Json記述例                                                |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "2100070001": [                                                       |
|                                                                       |
| 2100070001,                                                           |
|                                                                       |
| 2100070002,                                                           |
|                                                                       |
| 2100070003                                                            |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "2100020002": [                                                       |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "upload_id": "A_20191217090335772040239",※                            |
|                                                                       |
| "data_portability_upload_file_name":                                  |
| "ita_exportdata_20191213095733.kym"                                   |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ※UPLOADで取得した『upload_id』の先頭に”A_”を付与して使用します。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "TASK_ID": "メニューインポート実行の作業No",                          |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

表 3‑13　レスポンス項目一覧

+-------------------------------+--------------------------------------+
| 項目名                        | 備考                                 |
+===============================+======================================+
| TASK_ID                       | 作業No                               |
|                               |                                      |
|                               | 作業Noで[メニューエクスポート        |
|                               | ・インポート管理]メニューを検索する  |
|                               | ことにより、実行状況を確認できます。 |
+-------------------------------+--------------------------------------+
| RESULTCODE                    | コマンド実行の成否のコード           |
|                               |                                      |
|                               |    000：正常終了                     |
|                               |                                      |
|                               |    002：実行不可                     |
+-------------------------------+--------------------------------------+
| RESULTINFO                    | 詳細情報                             |
+-------------------------------+--------------------------------------+

Excel一括エクスポート/インポート利用編
======================================

Execl一括エクスポートを対象としたRestAPI
----------------------------------------

   Excel一括エクスポートの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[エクスポート/インポート]の、[Excel一括エクスポート]メニューに相当する操作です。

表 4‑1 メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| エ                    | Excel一括エクスポート    | 2100000329       |
| クスポート/インポート |                          |                  |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-3:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   3‑3　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 4‑2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | EXECUTE                                                 |
|            |                                                         |
|            | INFO                                                    |
|            |                                                         |
|            | の2つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

**表 4‑3　X-Commandに指定可能なパラメータ一覧**

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| INFO     | ダウンロード                  | Excel一括     | 21       |
|          | ファイルをエクスポート可能な  | エクスポート  | 00000329 |
|          | メニューの一覧を取得します。  |               |          |
+----------+-------------------------------+---------------+----------+
| EXECUTE  | 指定                          | Excel一括     | 21       |
|          | したメニューIDのダウンロード  | エクスポート  | 00000329 |
|          | ファイルをまとめたzipファイル |               |          |
|          | のエクスポートを実行します。  |               |          |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _info-1:

INFO
~~~~

   エクスポート可能なメニューの一覧を出力します。

   ・パラメータ

   　指定するパラメータはありません。

   　・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "MENU_LIST": {                                                        |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| "menu_group_name": "メニューグループ名",                              |
|                                                                       |
| "menu": [                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "menu_id": "メニューID ",                                             |
|                                                                       |
| "menu_name": "メニュー名"                                             |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| ]                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

表 4‑4　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| メニューグループID   | メニューグ                                    |
|                      | ループIDをキーとしてメニューの配列を構成する  |
+----------------------+-----------------------------------------------+
| menu_group_name      | メニューグループ名                            |
+----------------------+-----------------------------------------------+
| menu_id              | メニューID                                    |
+----------------------+-----------------------------------------------+
| menu_name            | メニュー名                                    |
+----------------------+-----------------------------------------------+

.. _execute-2:

EXECUTE
~~~~~~~

   対象のメニューを指定し、エクスポートを実行します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

**表 4‑5 Excel一括エクスポートパラメータ一覧**

+------------------------------+---------------------------------------+
| パラメータ名                 | 設定値                                |
+==============================+=======================================+
| メニューグループID           | メニューID                            |
+------------------------------+---------------------------------------+
| abolished_type               | 廃止情報                              |
|                              |                                       |
|                              | 1:全レコード                          |
|                              |                                       |
|                              | 2:廃止を除く                          |
|                              |                                       |
|                              | 3:廃止のみ                            |
+------------------------------+---------------------------------------+

..

   ※メニューグループID、メニューIDは、INFOの返り値で取得したものです。

+-----------------------------------------------------------------------+
| **例）JSON記述**                                                      |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "2100000002": [                                                       |
|                                                                       |
| “2100000202”,                                                         |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| “2100000222”                                                          |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "2100000003": [                                                       |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| “abolished_type”: “3”                                                 |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "TASK_ID": "実行No ",                                                 |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

表 4‑6　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| TASK_ID              | 作業No                                        |
|                      |                                               |
|                      | 作業Noで[Exc                                  |
|                      | el一括エクスポート・インポート管理]メニューを |
|                      | 検索することにより、実行状況を確認できます。  |
+----------------------+-----------------------------------------------+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：正常終了                              |
|                      |                                               |
|                      |    002：実行不可                              |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+

Excel一括インポートを対象としたRestAPI
--------------------------------------

   Excel一括インポートの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[エクスポート/インポート]の、[Excel一括ーインポート]メニューに相当する操作です。

表 4‑7 メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| エ                    | Excel一括インポート      | 2100000330       |
| クスポート/インポート |                          |                  |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-4:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表 3‑9
   X-Commandに指定可能なパラメータ一覧』　**\ を参照してください\ **。**

・HTTPヘッダ

**表 4‑8　HTTPヘッダパラメータ一覧**

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | UPLOAD                                                  |
|            |                                                         |
|            | EXECUTE                                                 |
|            |                                                         |
|            | の2つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 4‑9 X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| UPLOAD   | エクスポー                    | Excel一       | 21       |
|          | トしたzipファイルのアップロー | 括インポート  | 00000330 |
|          | ドを実施し、インポート可能な  |               |          |
|          | メニューリストを出力します。  |               |          |
+----------+-------------------------------+---------------+----------+
| EXECUTE  | インポート対象のメニューを選  | Excel一       | 21       |
|          | 択し、インポートを実施する。  | 括インポート  | 00000330 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _upload-1:

UPLOAD
~~~~~~

   エクスポートされたファイルのアップロードを実行します。

   ファイルはbase64encodeしたものをパラメータとして転送します。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

   **表 4‑10　Excel一括インポートUPLOADパラメータ一覧**

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| name                 | 対象のファイル名                              |
+----------------------+-----------------------------------------------+
| base64               | 対象のファイルをbase64encodeした値を指定      |
+----------------------+-----------------------------------------------+

+-----------------------------------------------------------------------+
| 1）UPLOAD　Json記述例                                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "zipfile":{                                                           |
|                                                                       |
| "name":"ITA_FILES_20191224092830.zip",                                |
|                                                                       |
| "base64":"・・・中略・・・"                                           |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": ""SUCCEED",                                                 |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "upload_id": "アップロードID ",※                                      |
|                                                                       |
| "data_portability_upload_file_name": "ファイル名",                    |
|                                                                       |
| “abolished_type”: “1”,                                                |
|                                                                       |
| "IMPORT_LIST": {                                                      |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| "menu_group_name": "メニューグループ名",                              |
|                                                                       |
| "menu": [                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "menu_id": "メニューID ",                                             |
|                                                                       |
| "menu_name": "メニュー名",                                            |
|                                                                       |
| “file_name”:”ファイル名”                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "UNIMPORT_LIST": {                                                    |
|                                                                       |
| "メニューグループID ": {                                              |
|                                                                       |
| "menu_group_name": "メニューグループ名",                              |
|                                                                       |
| "menu": [                                                             |
|                                                                       |
| {                                                                     |
|                                                                       |
| "menu_id": "メニューID ",                                             |
|                                                                       |
| "menu_name": "メニュー名",                                            |
|                                                                       |
| “file_name”:”ファイル名”,                                             |
|                                                                       |
| “error”:”エラー内容”                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ※『upload_id』インポートの操作（EXECUTE）する際に使用します。

表 4‑11　レスポンス項目一覧

+-------------------------------+--------------------------------------+
| 項目名                        | 備考                                 |
+===============================+======================================+
| upload_id                     | アップロード成功時に付与される値     |
|                               |                                      |
|                               | EXECUTE時に使用                      |
+-------------------------------+--------------------------------------+
| data                          | ファイル名                           |
| _portability_upload_file_name |                                      |
+-------------------------------+--------------------------------------+
| abolished_type                | 廃止情報                             |
|                               |                                      |
|                               | 1:全レコード                         |
|                               |                                      |
|                               | 2:廃止を除く                         |
|                               |                                      |
|                               | 3:廃止のみ                           |
+-------------------------------+--------------------------------------+
| IMPORT_LIST                   | インポートされるメニューリスト       |
+-------------------------------+--------------------------------------+
| UNIMPORT_LIST                 | インポート                           |
|                               | リストに指定していたが、エラーとなり |
|                               | インポートされなかったメニューリスト |
+-------------------------------+--------------------------------------+
| メニューグループID            | メニューグループID                   |
|                               | をキーとしてメニューの配列を構成する |
+-------------------------------+--------------------------------------+
| menu_group_name               | メニューグループ名                   |
+-------------------------------+--------------------------------------+
| menu_id                       | メニューID                           |
+-------------------------------+--------------------------------------+
| menu_name                     | メニュー名                           |
+-------------------------------+--------------------------------------+
| file_name                     | ファイル名                           |
+-------------------------------+--------------------------------------+
| error                         | エラー内容                           |
+-------------------------------+--------------------------------------+
| RESULTCODE                    | コマンド実行の成否のコード           |
|                               |                                      |
|                               |    000：正常終了                     |
|                               |                                      |
|                               |    002：実行不可                     |
+-------------------------------+--------------------------------------+
| RESULTINFO                    | 詳細情報                             |
+-------------------------------+--------------------------------------+

.. _execute-3:

EXECUTE
~~~~~~~

   アップロードしたファイルを元に、インポート処理を実行します。

   対象とする、メニューグループ、メニューIDを指定できます。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

**表 4‑12** Excel一括\ **インポートEXECUTEパラメータ**

+--------------------------+-----------+-------------------------------+
| パラメータ名             | 設定値    | 備考                          |
+==========================+===========+===============================+
| メニューグループID       | メ        |                               |
|                          | ニューID  |                               |
+--------------------------+-----------+-------------------------------+
| upload_id                |           | UPLOADの返り値で取得した      |
|                          |           | ものの先頭に”A_”を付与した値  |
+--------------------------+-----------+-------------------------------+
| data_port                | フ        |                               |
| ability_upload_file_name | ァイル名  |                               |
+--------------------------+-----------+-------------------------------+

+-----------------------------------------------------------------------+
| 1）EXECUTE　Json記述例                                                |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "2100070001": [                                                       |
|                                                                       |
| “2100070001”,                                                         |
|                                                                       |
| “2100070002”,                                                         |
|                                                                       |
| “2100070003”                                                          |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "2100020002": [                                                       |
|                                                                       |
| ・・・（中略）・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "upload_id": "A_20191217090335772040239",※                            |
|                                                                       |
| "data_portability_upload_file_name": "ITA_FILES_20191213095733.zip"   |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

..

   ※UPLOADで取得した『upload_id』の先頭に”A_”を付与して使用します。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "TASK_ID": "Excel一括インポート実行の作業No",                         |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

表 4‑13　レスポンス項目一覧

+-------------------------------+--------------------------------------+
| 項目名                        | 備考                                 |
+===============================+======================================+
| TASK_ID                       | 作業No                               |
|                               |                                      |
|                               | 作業Noで[Excel一括エクスポート       |
|                               | ・インポート管理]メニューを検索する  |
|                               | ことにより、実行状況を確認できます。 |
+-------------------------------+--------------------------------------+
| RESULTCODE                    | コマンド実行の成否のコード           |
|                               |                                      |
|                               |    000：正常終了                     |
|                               |                                      |
|                               |    002：実行不可                     |
+-------------------------------+--------------------------------------+
| RESULTINFO                    | 詳細情報                             |
+-------------------------------+--------------------------------------+

Symphony利用編
==============

Symphony登録作業を対象としたRestAPI
-----------------------------------

   Symphonyの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Symphony]の、[Symphonyクラス編集]メニューに相当する操作です。

表 5‑1 対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Symphony           | Symphonyクラス編集    | 2100000306             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-5:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑3　X-Commandに指定可能なパラメータ一覧』　**\ を参照してください\ **。**

・HTTPヘッダ

表 5‑2　HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | FILTER                                                  |
|            |                                                         |
|            | FILTER_DATAONLY                                         |
|            |                                                         |
|            | EDIT                                                    |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 5‑3　X-Commandに指定可能なパラメータ一覧

+---------------+------------------------------+-----------+----------+
| X-Command     | 説明                         | 対象画面  | メ       |
|               |                              |           | ニューID |
+===============+==============================+===========+==========+
| INFO          | Symphonyクラ                 | S         | 21       |
|               | スの列情報のみを取得します。 | ymphonyク | 00000306 |
|               |                              | ラス編集  |          |
+---------------+------------------------------+-----------+----------+
| FILTER        | Sympho                       | S         | 21       |
|               | nyクラスのパラメータに一致し | ymphonyク | 00000306 |
| FI            | たレコードの参照を行います。 | ラス編集  |          |
| LTER_DATAONLY |                              |           |          |
+---------------+------------------------------+-----------+----------+
| EDIT          | Symp                         | S         | 21       |
|               | honyクラスの登録を行います。 | ymphonyク | 00000306 |
|               |                              | ラス編集  |          |
+---------------+------------------------------+-----------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _info-2:

INFO
~~~~

   Symphonyクラスの列情報を取得します。

   ※詳細は『標準REST機能の利用』-『INFO(X-Command)』を参照

FILTER・FILTER_DATAONLY
~~~~~~~~~~~~~~~~~~~~~~~

   パラメータで指定した条件に合致したレコードの、列情報（列番号と列名）および、

   通常ステータス（廃止または活性中）の全レコードの行数とレコード内容と列情報を取得します。

   FILTER_DATAONLYを指定した場合は列情報を省略します。

   ※詳細は『標準REST機能の利用』-『FILTER(X-Command)』を参照

EDIT
~~~~

   Symphonyクラスの登録、更新、廃止、復活を行います。

・HTTPヘッダ

表 5‑4 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| Method                         | POST                                |
+--------------------------------+-------------------------------------+
| X-Command                      | EDIT                                |
+--------------------------------+-------------------------------------+

・パラメータ

1) 指定形式

..

   各実行種別のパラメータ指定項目は以下の、パラメータ指定項目を参照してください。

   項目番号7について、[更新]、[廃止]、[復活]指定時、

X-Command：FILTERで取得した、【更新用の最終更新日時】をセットしてください。

このデータによって、追い越し更新を防止しています。

【更新用の最終更新日時】は、“\ *T*\ \_“で始まっています。

**表 5‑5** **Symphonyクラスパラメータ一覧**

+-----+--------------------------+-------------------------------------+
| *   | **パラメータ名**         | **備考**                            |
| *項 |                          |                                     |
| 目  |                          |                                     |
| 番  |                          |                                     |
| 号  |                          |                                     |
| **  |                          |                                     |
+=====+==========================+=====================================+
| 0   | 実行処理種別             | 登録/更新/廃止/復活                 |
+-----+--------------------------+-------------------------------------+
| 2   | SymphonyクラスID         | 登録時は、空で実施。                |
+-----+--------------------------+-------------------------------------+
| 3   | Symphony名称             |                                     |
+-----+--------------------------+-------------------------------------+
| 4   | 説明                     |                                     |
+-----+--------------------------+-------------------------------------+
| 5   | アクセ                   | ロール名称カンマ区切りで入力        |
|     | ス権/アクセス許可ロール  |                                     |
+-----+--------------------------+-------------------------------------+
| 6   | 備考                     |                                     |
+-----+--------------------------+-------------------------------------+
| 7   | 更新用の最終更新日時     | T_XXXXXXXXXXXXXXXXXXXX              |
+-----+--------------------------+-------------------------------------+
| 10  | Movement詳細             | Movement情報                        |
|     |                          |                                     |
|     |                          | 詳細は以下、表 5‑6                  |
+-----+--------------------------+-------------------------------------+

　　　　　　

**表 5‑6** **Movement詳細一覧**

+-----+------------------------+--------------------------------------+
| *   | **パラメータ名**       | **備考**                             |
| *項 |                        |                                      |
| 目  |                        |                                      |
| 番  |                        |                                      |
| 号  |                        |                                      |
| **  |                        |                                      |
+=====+========================+======================================+
| 0   | Orchestrator ID        | オーケストレータのID                 |
|     |                        |                                      |
|     |                        | 対応表は以下表 5‑8                   |
+-----+------------------------+--------------------------------------+
| 1   | Movement ID            | Movement のID                        |
|     |                        |                                      |
|     |                        | [Movement一覧]メニュー参照           |
+-----+------------------------+--------------------------------------+
| 2   | 一時停止               | OFF:空                               |
|     |                        |                                      |
|     |                        | ON:checkedValue                      |
+-----+------------------------+--------------------------------------+
| 3   | 説明                   |                                      |
+-----+------------------------+--------------------------------------+
| 4   | オペ                   | オペレーションのID                   |
|     | レーションID(個別指定) |                                      |
|     |                        | [投入オペレーション]メニューを参照。 |
+-----+------------------------+--------------------------------------+

**表 5‑7** **SymphonyクラスパラメータMovement詳細**

+-----------------------------------------------------------------------+
| **　パラメータ指定項目（登録/更新）**                                 |
+=======================================================================+
| "10": [                                                               |
|                                                                       |
| {                                                                     |
|                                                                       |
| "0": "Orchestrator ID",                                               |
|                                                                       |
| "1": "Movement ID",                                                   |
|                                                                       |
| "2": "一時停止(OFF:/ON:checkedValue)",                                |
|                                                                       |
| "3": "説明",                                                          |
|                                                                       |
| "4": "オペレーションID(個別指定)"                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| {                                                                     |
|                                                                       |
| **・・・複数のMovement実行の場合、実行順に追加・・・・**              |
|                                                                       |
| }                                                                     |
|                                                                       |
| ]                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

表 5‑8　オーケストレータのID対応表

+-----------------+----------------------------------------------------+
| ID              | ステータス                                         |
+=================+====================================================+
| 3               | Ansible Legacy                                     |
+-----------------+----------------------------------------------------+
| 4               | Ansible Pioneer                                    |
+-----------------+----------------------------------------------------+
| 5               | Ansible Legacy Role                                |
+-----------------+----------------------------------------------------+
| 10              | Terraform                                          |
+-----------------+----------------------------------------------------+

+-----------------------------------------------------------------------+
| **　パラメータ指定項目（登録/更新）**                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "0": "実行処理種別：<登録 or 更新>",                                  |
|                                                                       |
| "2": "SymphonyクラスID ",                                             |
|                                                                       |
| "3": "Symphony名称",                                                  |
|                                                                       |
| "4": "説明",                                                          |
|                                                                       |
| "5": "アクセス権/アクセス許可ロール",                                 |
|                                                                       |
| "6": "備考",                                                          |
|                                                                       |
| "7": "更新用の最終更新日時",                                          |
|                                                                       |
| "10": [                                                               |
|                                                                       |
| {                                                                     |
|                                                                       |
| "0": "Orchestrator ID",                                               |
|                                                                       |
| "1": "Movement ID",                                                   |
|                                                                       |
| "2": "一時停止(OFF:/ON:checkedValue)",                                |
|                                                                       |
| "3": "説明",                                                          |
|                                                                       |
| "4": "オペレーションID(個別指定)"                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| **・・・複数の場合、Movementの実行順で繰り返し追加・・・・**          |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| **　パラメータ指定項目（廃止/復活）**                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "0": "実行処理種別：<廃止 or 復活>",                                  |
|                                                                       |
| "2": "SymphonyクラスID",                                              |
|                                                                       |
| "7": "更新用の最終更新日時"                                           |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

※Method：GET、X-Command：FILTERで取得した、【更新用の最終更新日時】をセット

してください。このデータによって、追い越し更新を防止しています。

【更新用の最終更新日時】は、“\ *T*\ \_“で始まっています。

+-----------------------------------------------------------------------+
| **例）JSON記述例：複数の実行処理種別対象とした場合**                  |
+=======================================================================+
|    [                                                                  |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": "登録",                                                       |
|                                                                       |
|    "2": "",                                                           |
|                                                                       |
|    "3": "DEMO_001_20191224135448_0",                                  |
|                                                                       |
|    "4": "demo_001_20191224135448_0",                                  |
|                                                                       |
|    "5": "ロールA,ロールB",                                            |
|                                                                       |
|    "7": "",                                                           |
|                                                                       |
|    "10": [                                                            |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": 3,                                                            |
|                                                                       |
|    "1": 1,                                                            |
|                                                                       |
|    "2": "checkedValue",                                               |
|                                                                       |
|    "3": "DEMO_MOVE_0",                                                |
|                                                                       |
|    "4": 1                                                             |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": 3,                                                            |
|                                                                       |
|    "1": 2,                                                            |
|                                                                       |
|    "2": "",                                                           |
|                                                                       |
|    "3": "DEMO_MOVE_1",                                                |
|                                                                       |
|    "4": ""                                                            |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    ]                                                                  |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": "更新",                                                       |
|                                                                       |
|    "2": 1,                                                            |
|                                                                       |
|    "3": "DEMO_001_20191224135448_1",                                  |
|                                                                       |
|    "4": "demo_001_20191224135448_1",                                  |
|                                                                       |
|    "7": "T_20191224113132971799",                                     |
|                                                                       |
|    "10": [                                                            |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": 3,                                                            |
|                                                                       |
|    "1": 1,                                                            |
|                                                                       |
|    "2": "",                                                           |
|                                                                       |
|    "3": "DEMO_MOVE_0",                                                |
|                                                                       |
|    "4": 1                                                             |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    ]                                                                  |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": "廃止",                                                       |
|                                                                       |
|    "2": 2,                                                            |
|                                                                       |
|    "7": "T_20191224135437197447"                                      |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    {                                                                  |
|                                                                       |
|    "0": "復活",                                                       |
|                                                                       |
|    "2": 4,                                                            |
|                                                                       |
|    "7": "T_20191224135449793941"                                      |
|                                                                       |
|    }                                                                  |
|                                                                       |
| ]                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

・レスポンス

登録・更新のRAW出力

表 4‑9 Keyパラメータ一覧

+--------------+--------------+----------------------------------------+
| **key**      | **値の型**   | **　**                                 |
+==============+==============+========================================+
| 0            | 文字列       | 結果コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 1            | 文字列       | 詳細コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 2            | 文字列       | SymphonyクラスID                       |
+--------------+--------------+----------------------------------------+
| 3            | 文字列       | エラーメッセージ                       |
+--------------+--------------+----------------------------------------+

..

   各レコードの処理結果について、廃止・復活時のRAW出力は『標準REST機能の利用』-『EDIT(X-Command)』を参照。

Symphony作業実行を対象としたRestAPI
-----------------------------------

   Symphonyの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Symphony]の、[Symphony作業実行]メニュー、[Symphony作業確認]メニューに相当する操作です。

表 5‑9　対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Symphony           | Symphony作業実行      | 2100000308             |
+--------------------+-----------------------+------------------------+
|                    | Symphony作業確認      | 2100000309             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-6:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑11　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 5‑10 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | EXECUTE                                                 |
|            |                                                         |
|            | CANCEL                                                  |
|            |                                                         |
|            | SCRAM                                                   |
|            |                                                         |
|            | RELEASE                                                 |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 5‑11　X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| EXECUTE  | S                             | Sym           | 21       |
|          | ymphonyの作業実行を行います。 | phony作業実行 | 00000308 |
+----------+-------------------------------+---------------+----------+
| CANCEL   | Symph                         | Sym           | 21       |
|          | onyの予約取り消しを行います。 | phony作業確認 | 00000309 |
+----------+-------------------------------+---------------+----------+
| SCRAM    | S                             | Sym           | 21       |
|          | ymphonyの緊急停止を行います。 | phony作業確認 | 00000309 |
+----------+-------------------------------+---------------+----------+
| RELEASE  | Symphonyの一時停              | Sym           | 21       |
|          | 止ポイントの解除を行います。  | phony作業確認 | 00000309 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

レスポンスの項目
~~~~~~~~~~~~~~~~

以下では、それぞれのX-comannd実行時のレスポンス項目についての説明を行います。

表 5‑12　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| SYMPHONY_INSTANCE_ID | SYMPHONYインスタンスに対する操作に使用        |
+----------------------+-----------------------------------------------+
| MOVEMENT_SEQ_NO      | RELEASE時のみ使用                             |
+----------------------+-----------------------------------------------+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：正常終了                              |
|                      |                                               |
|                      |    001：実行不可                              |
|                      |                                               |
|                      |    002：予約取消不可                          |
|                      |                                               |
|                      |    003：緊急停止不可                          |
|                      |                                               |
|                      |    004：一時停止解除不可                      |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+

.. _execute-4:

EXECUTE
~~~~~~~

   Symphonyクラスとオペレーションを指定して、作業実行を行います。予約日時の指定や、Symphony

   クラスに登録されているMovementごとに、スキップ、オペレーションIDの個別指定ができます。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

表 5‑13　オペレーションID　個別指定パラメータ一覧

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| SYMPHONY_CLASS_NO    | SymphonyクラスID                              |
+----------------------+-----------------------------------------------+
| OPERATION_ID         | オペレーションID                              |
+----------------------+-----------------------------------------------+
| PRESERVE_DATETIME    | 予約日時（YYYY/MM/DD ｔｔ:ｍｍ）              |
+----------------------+-----------------------------------------------+
| OPTION               | スキ                                          |
|                      | ップの有無、オペレーションIDの個別指定の配列  |
+----------------------+-----------------------------------------------+

..

   ・OPTIONの指定

   　　OPTIONには、配列でMovementごとに、スキップ、オペレーションIDの個別指定ができます。

   ・Movement要素の階層

   ├1（Movementの実行順番）

   ｜　　　　├SKIP　‐　YES or NO

   ｜ └OPERATION_ID ‐ (個別指定するオペレーションID)

   ├2（Movementの実行順番）

   ｜ ├SKIP　‐　YES or NO

   ｜ └OPERATION_ID ‐ (個別指定するオペレーションID)

   ・

   ・

+-----------------------------------------------------------------------+
| 1）EXECUTE　Json記述例                                                |
+=======================================================================+
| SymphonyクラスIDが1、オペレーションIDが1001、予約日時が2016/01/01     |
| 00:00の場合                                                           |
|                                                                       |
| さらに、1番目に実行されるMovement                                     |
| をスキップし、2番目に実行されるMovementのオペレーションIDに2001を指定 |
|                                                                       |
| ▽Json形式で記述                                                       |
|                                                                       |
| {                                                                     |
|                                                                       |
| "SYMPHONY_CLASS_NO": 1,                                               |
|                                                                       |
| "OPERATION_ID": 1001,                                                 |
|                                                                       |
| "PRESERVE_DATETIME": "2016/01/0100:00",                               |
|                                                                       |
| "OPTION": {                                                           |
|                                                                       |
| "1": {                                                                |
|                                                                       |
| "SKIP": "YES"                                                         |
|                                                                       |
| },                                                                    |
|                                                                       |
| "2": {                                                                |
|                                                                       |
| "OPERATION_ID": 2001                                                  |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

**図 6.1-1 EXECUTE　Json記述例**

   　・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "実行の成否",                                               |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "SYMPHONY_INSTANCE_ID": "実行No ",※                                   |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ※実行後のインスタンスを操作（INFO,CANCEL、SCRAM、RELEASE）する際に使用します。

CANCEL
~~~~~~

   予約日時が登録されているSymphonyのインスタンスIDを指定して、予約実行をキャンセルします。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 5‑14　 Symphony実行予約キャンセルパラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| SYMPHONY_INSTANCE_ID           | SymphonyインスタンスID※             |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| " SYMPHONY_INSTANCE_ID": " Symphony実行時のインスタンスのID ",        |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

SCRAM
~~~~~

   実行されているSymphonyのインスタンスIDを指定して、緊急停止します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 5‑15 Symphony実行処理の緊急停止パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| SYMPHONY_INSTANCE_ID           | SymphonyインスタンスID※             |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| " SYMPHONY_INSTANCE_ID": " Symphony実行時のインスタンスのID ",        |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

RELEASE
~~~~~~~

   SymphonyのインスタンスIDとMovementの順番を指定して、一時停止が設定されているポイントを解除します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 5‑16 Symphony実行処理の一時停止解除パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| SYMPHONY_INSTANCE_ID           | SymphonyインスタンスID※             |
+--------------------------------+-------------------------------------+
| MOVEMENT_SEQ_NO                | 何番目のMovementか                  |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "SYMPHONY_INSTANCE_ID": "Symphony実行時のインスタンスのID",           |
|                                                                       |
| "MOVEMENT_SEQ_NO": "実行したMovementのSymphonyクラス内の順番",        |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

Symphony作業確認を対象としたRestAPI
-----------------------------------

   Symphonyの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Symphony]の、[Symphony作業確認]メニューに相当する操作です。

表 5‑17　対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Symphony           | Symphony作業確認      | 2100000309             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-7:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑19　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 5‑18 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | の1つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 5‑19　X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| INFO     | Symphonyの状態確認            | Sym           | 21       |
|          | をし、ステータスを返します。  | phony作業確認 | 00000309 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _レスポンスの項目-1:

レスポンスの項目
~~~~~~~~~~~~~~~~

以下では、それぞれのX-comannd実行時のレスポンス項目についての説明を行います。

表 5‑20　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| SYMPHONY_INSTANCE_ID | SYMPHONYインスタンスに対する操作に使用        |
+----------------------+-----------------------------------------------+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：正常終了                              |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+

.. _info-3:

INFO
~~~~

   Symphony実行時のインスタンスIDを指定して、実行時の情報を取得します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 5‑21　Symphony実行情報取得パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| SYMPHONY_INSTANCE_ID           | SymphonyインスタンスID※             |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "SYMPHONY_CLASS_ID": "1",                                             |
|                                                                       |
| "SYMPHONY_INSTANCE_INFO": {                                           |
|                                                                       |
| "SYMPHONY_INSTANCE_ID": 1,                                            |
|                                                                       |
| ・・・（中略）項目は以下①参照・・・                                   |
|                                                                       |
| "FOCUS_MOVEMENT": 1                                                   |
|                                                                       |
| },                                                                    |
|                                                                       |
| "MOVEMENTS": [                                                        |
|                                                                       |
| {                                                                     |
|                                                                       |
| "CLASS_ITEM": {                                                       |
|                                                                       |
| "ORCHESTRATOR_ID": "3",                                               |
|                                                                       |
| ・・・（中略）項目は以下②参照・・・                                   |
|                                                                       |
| "NEXT_PENDING": "checkedValue"                                        |
|                                                                       |
| },                                                                    |
|                                                                       |
| "INS_ITEM": {                                                         |
|                                                                       |
| "STATUS": "11",                                                       |
|                                                                       |
| ・・・（中略）項目は以下③参照・・・                                   |
|                                                                       |
| "OPERATION_NAME": null                                                |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| 　　　　　　・・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "RESULTCODE": "000",                                                  |
|                                                                       |
| "RESULTINFO": ""                                                      |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

　　　

   ①SYMPHONY_INSTANCE_INFOに格納されるSymphonyインスタンスの情報配列

表 5‑22　インスタンス配列表

+---------------------------+------------------------------------------+
| キー                      | 内容                                     |
+===========================+==========================================+
| SYMPHONY_INSTANCE_ID      | SymphonyインスタンスID                   |
+---------------------------+------------------------------------------+
| I_SYMPHONY_CLASS_NO       | このインスタンスの元クラスのID           |
+---------------------------+------------------------------------------+
| I_SYMPHONY_NAME           | このインスタンスの元クラスの名前         |
+---------------------------+------------------------------------------+
| I_DESCRIPTION             | このインスタンスの元クラスの説明         |
+---------------------------+------------------------------------------+
| STATUS_ID                 | 実行時ステータス　詳細は以下　表 5‑25    |
+---------------------------+------------------------------------------+
| ABORT_EXECUTE_FLAG        | 緊急                                     |
|                           | 停止発令フラグ　未発令：１　発令済み：２ |
+---------------------------+------------------------------------------+
| OPERATION_NO_UAPK         | 登録オペレーションNO                     |
+---------------------------+------------------------------------------+
| OPERATION_NO_IDBH         | 登録オペレーションID                     |
+---------------------------+------------------------------------------+
| OPERATION_NAME            | 登録オペレーション名                     |
+---------------------------+------------------------------------------+
| TIME_BOOK                 | 予約日時                                 |
+---------------------------+------------------------------------------+
| TIME_START                | 開始日時                                 |
+---------------------------+------------------------------------------+
| TIME_END                  | 終了日時                                 |
+---------------------------+------------------------------------------+
| MOVEMENT_LENGTH           | 登録Movementの数                         |
+---------------------------+------------------------------------------+
| FOCUS_MOVEMENT            | 現在のMovementは何番目か                 |
+---------------------------+------------------------------------------+

..

   ②CLASS_ITEMに格納されるMovementのクラス情報

表 5‑23　Movementクラス情報表

+---------------------------+------------------------------------------+
| キー                      | 内容                                     |
+===========================+==========================================+
| ORCHESTRATOR_ID           | オーケストレータのID　　対応表は以下　表 |
|                           | 5‑26                                     |
+---------------------------+------------------------------------------+
| PATTERN_ID                | MovementのID                             |
+---------------------------+------------------------------------------+
| PATTERN_NAME              | Movementの名前                           |
+---------------------------+------------------------------------------+
| THEME_COLOR               | <画面用>Web画面で設定時の○アイコンの色   |
+---------------------------+------------------------------------------+
| MOVEMENT_SEQ              | Symphonyクラスの中で何番目か             |
+---------------------------+------------------------------------------+
| DESCRIPTION               | Symphonyクラス編集画面で入力したコメント |
+---------------------------+------------------------------------------+
| NEXT_PENDING              | 一時停止が設定されている：checkedValue   |
+---------------------------+------------------------------------------+

..

   ③INS_ITEMに格納されるMovementのインスタンス情報

表 5‑24　Movementインスタンス情報表

+---------------------------+------------------------------------------+
| キー                      | 内容                                     |
+===========================+==========================================+
| STATUS                    | 実行時ステータス　詳細は以下　表 5‑27    |
+---------------------------+------------------------------------------+
| RELEASED                  | 一時停止が設定されている:1　             |
|                           |                                          |
|                           | 一時停止解除された：2                    |
+---------------------------+------------------------------------------+
| EXECUTION_NO              | MovementインスタンスID                   |
+---------------------------+------------------------------------------+
| JUMP                      | <画面用>遷移先URL                        |
+---------------------------+------------------------------------------+
| ABORT_RECEPTED            | 緊急停                                   |
|                           | 止を　１：受け付けていない　２：受付済み |
+---------------------------+------------------------------------------+
| SKIP                      | スキップが設定されている　：1            |
+---------------------------+------------------------------------------+
| TIME_START                | 開始日時                                 |
+---------------------------+------------------------------------------+
| TIME_END                  | 終了日時                                 |
+---------------------------+------------------------------------------+
| OPERATION_ID              | 個別指定されたオペレーションID           |
+---------------------------+------------------------------------------+
| OPERATION_NAME            | 個別指定されたオペレーション名           |
+---------------------------+------------------------------------------+

表 5‑25　Symphonyインスタンスの実行時ステータスID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | 未実行                                        |
+----------------------+-----------------------------------------------+
| 2                    | 未実行(予約)                                  |
+----------------------+-----------------------------------------------+
| 3                    | 実行中                                        |
+----------------------+-----------------------------------------------+
| 4                    | 実行中(遅延)                                  |
+----------------------+-----------------------------------------------+
| 5                    | 正常終了                                      |
+----------------------+-----------------------------------------------+
| 6                    | 緊急停止                                      |
+----------------------+-----------------------------------------------+
| 7                    | 異常終了                                      |
+----------------------+-----------------------------------------------+
| 8                    | 想定外エラー                                  |
+----------------------+-----------------------------------------------+
| 9                    | 予約取消                                      |
+----------------------+-----------------------------------------------+

表 5‑26　オーケストレータのID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 3                    | Ansible Legacy                                |
+----------------------+-----------------------------------------------+
| 4                    | Ansible Pioneer                               |
+----------------------+-----------------------------------------------+
| 5                    | Ansible Legacy Role                           |
+----------------------+-----------------------------------------------+
| 10                   | Terraform                                     |
+----------------------+-----------------------------------------------+

表 5‑27 Movementインスタンスの実行時ステータスID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | 未実行                                        |
+----------------------+-----------------------------------------------+
| 2                    | 準備中                                        |
+----------------------+-----------------------------------------------+
| 3                    | 実行中                                        |
+----------------------+-----------------------------------------------+
| 4                    | 実行中(遅延)                                  |
+----------------------+-----------------------------------------------+
| 5                    | 実行完了                                      |
+----------------------+-----------------------------------------------+
| 6                    | 異常終了                                      |
+----------------------+-----------------------------------------------+
| 7                    | 緊急停止                                      |
+----------------------+-----------------------------------------------+
| 8                    | 保留中                                        |
+----------------------+-----------------------------------------------+
| 9                    | 正常終了                                      |
+----------------------+-----------------------------------------------+
| 10                   | 準備エラー                                    |
+----------------------+-----------------------------------------------+
| 11                   | 想定外エラー                                  |
+----------------------+-----------------------------------------------+
| 12                   | Skip完了                                      |
+----------------------+-----------------------------------------------+
| 13                   | Skip後保留中                                  |
+----------------------+-----------------------------------------------+
| 14                   | Skip終了                                      |
+----------------------+-----------------------------------------------+

Symphony作業一覧を対象としたRestAPI
-----------------------------------

.. _リクエストの形式-8:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑19　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 5‑28 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | FILTER                                                  |
|            |                                                         |
|            | FILTER_DATAONLY                                         |
|            |                                                         |
|            | EDIT                                                    |
|            |                                                         |
|            | DOWNLOAD                                                |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 5‑29　X-Commandに指定可能なパラメータ一覧

+---------------+---------------------------+--------------+----------+
| X-Command     | 説明                      | 対象画面     | メ       |
|               |                           |              | ニューID |
+===============+===========================+==============+==========+
| INFO          | Symphony作業一覧の        | Symp         | 21       |
|               | 列情報のみを取得します。  | hony作業一覧 | 00000310 |
+---------------+---------------------------+--------------+----------+
| FILTER        | Symphony作業一覧          | Symp         | 21       |
|               | のパラメータに一致したレ  | hony作業一覧 | 00000310 |
| FI            | コードの参照を行います。  |              |          |
| LTER_DATAONLY |                           |              |          |
+---------------+---------------------------+--------------+----------+
| EDIT          | Symphony作                | Symp         | 21       |
|               | 業一覧の更新を行います。  | hony作業一覧 | 00000310 |
+---------------+---------------------------+--------------+----------+
| DOWNLOAD      | Symphony作業一            | Symp         | 21       |
|               | 覧の投入データ一式と結果  | hony作業一覧 | 00000310 |
|               | データ一式を取得します。  |              |          |
+---------------+---------------------------+--------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _info-4:

INFO
~~~~

   Symphony作業一覧の列情報を取得します。

   ※詳細は『標準REST機能の利用』-『INFO(X-Command)』を参照

.. _filterfilter_dataonly-1:

FILTER・FILTER_DATAONLY
~~~~~~~~~~~~~~~~~~~~~~~

   パラメータで指定した条件に合致したレコードの、列情報（列番号と列名）および、

   通常ステータス（廃止または活性中）の全レコードの行数とレコード内容と列情報を取得します。

   FILTER_DATAONLYを指定した場合は列情報を省略します。

   ※詳細は『標準REST機能の利用』-『FILTER(X-Command)』を参照

.. _edit-1:

EDIT
~~~~

   Symphony作業一覧の更新、廃止、復活を行います。

   ただし、ロール・メニュー紐付管理で紐付が「メンテナンス可」の場合のみ行えます。

   ※詳細は『標準REST機能の利用』-『EDIT(X-Command)』を参照

DOWNLOAD
~~~~~~~~

　　　パラメータで指定した条件に合致したレコードの、投入データ一式と結果データ一式の

　　　ZipファイルをBASE64でエンコードして取得します。

**表 5‑20** **Symphonyクラスパラメータ一覧**

+-------------------------------+--------------------------------------+
| **項目キー名**                | **パラメータ名**                     |
+===============================+======================================+
| SYMPHONY_INSTANCE_NO          | 取得したいレコードの                 |
|                               | SynphonyインスタンスNoをカンマ区切り |
+-------------------------------+--------------------------------------+

+-----------------------------------------------------------------------+
| **　例）JSON記述例：SynphonyインスタンスNo1と2を対象にした場合**      |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "SYMPHONY_INSTANCE_NO": [                                             |
|                                                                       |
| 　 "1",                                                               |
|                                                                       |
| "2"                                                                   |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

・レスポンス

1)レコード行数

（JSON形式）

キー{resultdata} -> キー{CONTENTS} -> キー{RECORD_LENGTH}の中に、

数値として格納されます。

2) レコード情報

（JSON形式）（1行につき1個の配列（列キーと列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
   キー{0}の中に0から始まる数値を、キーとする配列として格納されます。

**表 5‑21** **レスポンスパラメータ一覧**

+-------------------------------+---------------------------------------+
|    列キー名                   |    列名                               |
+===============================+=======================================+
| SYMPHONY_INSTANCE_NO          | SynphonyインスタンスNo                |
+-------------------------------+---------------------------------------+
| INPUT_DATA                    | 投入データ一式ファイル名              |
+-------------------------------+---------------------------------------+
| RESULT_DATA                   | 結果データ一式ファイル名              |
+-------------------------------+---------------------------------------+

3)ファイル情報

（JSON形式）（1行につき1個の配列（列キーと列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{ DOWNLOAD_FILE} ->
   キー{0}の中に0から始まる数値を、キーとする配列として格納されます。

**表 5‑21** **レスポンスパラメータ一覧**

+-------------------------------+---------------------------------------+
|    列キー名                   |    列名                               |
+===============================+=======================================+
| 投入データ一式ファイル名      | ダウンロー                            |
|                               | ドファイルをBASE64でエンコードした値  |
+-------------------------------+---------------------------------------+
| 結果データ一式ファイル名      | ダウンロー                            |
|                               | ドファイルをBASE64でエンコードした値  |
+-------------------------------+---------------------------------------+

..

   ・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| “RECORD_LENGTH”:取得件数                                              |
|                                                                       |
| "BODY": {                                                             |
|                                                                       |
| "0":{                                                                 |
|                                                                       |
| "SYMPHONY_INSTANCE_NO": SynphonyインスタンスNo                        |
|                                                                       |
| "INPUT_DATA ":投入データ一式ファイル名                                |
|                                                                       |
| "RESULT_DATA":結果データ一式ファイル名                                |
|                                                                       |
| },                                                                    |
|                                                                       |
| ・・・取得件数分繰り返し・・・                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| "DOWNLOAD_FILE:{                                                      |
|                                                                       |
| "0"{                                                                  |
|                                                                       |
| "投入                                                                 |
| データ一式ファイル名":ダウンロードファイルをBASE64でエンコードした値  |
|                                                                       |
| "結果                                                                 |
| データ一式ファイル名":ダウンロードファイルをBASE64でエンコードした値  |
|                                                                       |
| }                                                                     |
|                                                                       |
| ・・・取得件数分繰り返し・・・                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

Conductor利用編
===============

Conductor登録作業を対象としたRestAPI
------------------------------------

   Conductorの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Conductor]の、[Conductorクラス編集]メニューに相当する操作です。

表 6‑1 対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Conductor          | Conductorクラス編集   | 2100180003             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-9:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表6-3』**\ を参照してください\ **。**

・HTTPヘッダ

表 6‑2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | FILTER                                                  |
|            |                                                         |
|            | FILTER_DATAOLY                                          |
|            |                                                         |
|            | EDIT                                                    |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 6‑3 X-Commandに指定可能なパラメータ一覧

+---------------+------------------------------+-----------+----------+
| X-Command     | 説明                         | 対象画面  | メ       |
|               |                              |           | ニューID |
+===============+==============================+===========+==========+
| INFO          | Conductorクラ                | Co        | 21       |
|               | スの列情報のみを取得します。 | nductorク | 00180003 |
|               |                              | ラス編集  |          |
+---------------+------------------------------+-----------+----------+
| FILTER        | Conduct                      | Co        | 21       |
| FI            | orクラスのパラメータに一致し | nductorク | 00180003 |
| LTER_DATAONLY | たレコードの参照を行います。 | ラス編集  |          |
+---------------+------------------------------+-----------+----------+
| EDIT          | Condu                        | Co        | 21       |
|               | ctorクラスの登録を行います。 | nductorク | 00180003 |
|               |                              | ラス編集  |          |
+---------------+------------------------------+-----------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _info-5:

INFO
~~~~

   Conductorクラスの列情報を取得します。

   ※詳細は『標準REST機能の利用』-『INFO(X-Command)』を参照

+-----------------------------------------------------------------------+
| **例）INFO取得例**                                                    |
+=======================================================================+
| {…                                                                    |
|                                                                       |
|    "INFO":{                                                           |
|                                                                       |
| "edittype": "実行処理種別",                                           |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "conductor_name":"Conductor名称",                                     |
|                                                                       |
| "id":" ConductorクラスID",                                            |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "LUT4U":"更新用の最終更新日時",                                       |
|                                                                       |
| "ACCESS_AUTH":"アクセス権/アクセス許可ロール",                        |
|                                                                       |
| "NOTICE_INFO":"通知設定"                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "config": {                                                           |
|                                                                       |
| "editorVersion":"Editor情報",                                         |
|                                                                       |
| "nodeNumber":" Node数",                                               |
|                                                                       |
| "terminalNumber":"Terminal数",                                        |
|                                                                       |
| "edgeNumber":"Edge数"                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node": {                                                             |
|                                                                       |
| "h":"高さ",                                                           |
|                                                                       |
| "id":" Node class id",                                                |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "case":"Case no",                                                     |
|                                                                       |
| "edge":" 紐付Line",                                                   |
|                                                                       |
| "id":"Terminal class id",                                             |
|                                                                       |
| "targetNode":"紐付Node"                                               |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "condition":"状態",                                                   |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "END_TYPE":"終了種別",                                                |
|                                                                       |
| "PATTERN_ID":"Pattern id",                                            |
|                                                                       |
| "ORCHESTRATOR_ID":"Orchestrator id",                                  |
|                                                                       |
| "Name":" Movement名",                                                 |
|                                                                       |
| "CALL_CONDUCTOR_ID":"ConductorクラスID",                              |
|                                                                       |
| "CONDUCTOR_NAME":"Conductor名称",                                     |
|                                                                       |
| "CALL_SYMPHONY_ID":"SymphonyクラスID",                                |
|                                                                       |
| "SYMPHONY_NAME":"Symphony名称",                                       |
|                                                                       |
| "OPERATION_NO_IDBH:" オペレーションID",                               |
|                                                                       |
| "SKIP_FLAG":"Skip flag",                                              |
|                                                                       |
| "OPERATION_NAME":"オペレーション名",                                  |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "w":"幅",                                                             |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "line": {                                                             |
|                                                                       |
| "id":"Line id",                                                       |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "inNode":"内側接続Node",                                              |
|                                                                       |
| "outTerminal":"外側接続Terminal "                                     |
|                                                                       |
| "inTerminal":"内側接続Terminal ",                                     |
|                                                                       |
| "outNode ":"外側接続Node "                                            |
|                                                                       |
| }                                                                     |
|                                                                       |
|    }                                                                  |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   各項目キーの内容は表 6‑4～表 6‑9参照

表 6‑4 Conductorクラスパラメータ一覧

+------------+---------------------+-----------------------------------+
| **         | **パラメータ名**    | **備考**                          |
| 項目キー** |                     |                                   |
+============+=====================+===================================+
| edittype   | 実行処理種別        | 登録/更新/廃止/復活               |
+------------+---------------------+-----------------------------------+
| conductor  | Conductor詳細       | Conductor情報                     |
|            |                     |                                   |
|            |                     | 詳細は以下、表 6‑5                |
+------------+---------------------+-----------------------------------+
| config     | Config名称          | Config情報                        |
|            |                     |                                   |
|            |                     | 詳細は以下、表 6‑6                |
+------------+---------------------+-----------------------------------+
| node       | Node詳細            | Node情報                          |
|            |                     |                                   |
|            |                     | 詳細は以下、表 6‑7                |
+------------+---------------------+-----------------------------------+
| terminal   | Terminal詳細        | Terminal情報                      |
|            |                     |                                   |
|            |                     | 詳細は以下、表 6‑8                |
+------------+---------------------+-----------------------------------+
| line       | Line詳細            | Line情報                          |
|            |                     |                                   |
|            |                     | 詳細は以下、表 6‑9                |
+------------+---------------------+-----------------------------------+

　　

表 6‑5 Conductor詳細一覧

+---------------+---------------------+-------------------------------+
| **項目キー**  | **パラメータ名**    | **備考**                      |
+===============+=====================+===============================+
| c             | Conductor名称       |                               |
| onductor_name |                     |                               |
+---------------+---------------------+-------------------------------+
| id            | ConductorクラスID   | 登録時は、空で実施。          |
+---------------+---------------------+-------------------------------+
| note          | 説明                |                               |
+---------------+---------------------+-------------------------------+
| LUT4U         | 更                  | T_XXXXXXXXXXXXXXXXXXXX        |
|               | 新用の最終更新日時  |                               |
+---------------+---------------------+-------------------------------+
| ACCESS_AUTH   | アクセス権          |                               |
|               | /アクセス許可ロール |                               |
+---------------+---------------------+-------------------------------+
| NOTICE_INFO   | 通知設定            | {"<通知ID>":"                 |
|               |                     | <ステータスIDカンマ区切り>"}} |
|               |                     | ステータスID詳細は以下、表    |
|               |                     | 6‑10                          |
+---------------+---------------------+-------------------------------+

表 6‑6 Config詳細一覧

+---------------+---------------------+-------------------------------+
| **項目キー**  | **パラメータ名**    | **備考**                      |
+===============+=====================+===============================+
| editorVersion | Editor情報          |                               |
+---------------+---------------------+-------------------------------+
| nodeNumber    | Node数              |                               |
+---------------+---------------------+-------------------------------+
| t             | Terminal数          |                               |
| erminalNumber |                     |                               |
+---------------+---------------------+-------------------------------+
| edgeNumber    | Edge数              |                               |
+---------------+---------------------+-------------------------------+

表 6‑7 Node詳細一覧

+---------------------+---------------+--------------------------------+
| **項目キー**        | **パ          | **備考**                       |
|                     | ラメータ名**  |                                |
+=====================+===============+================================+
| h                   | 高さ          |                                |
+---------------------+---------------+--------------------------------+
| id                  | Node class id |                                |
+---------------------+---------------+--------------------------------+
| type                | 種別          | start/e                        |
|                     |               | nd/movement/call/call_s/pause/ |
|                     |               | conditional-branch/            |
|                     |               | parallel-branch/               |
|                     |               | par                            |
|                     |               | allel-merge/status-file-branch |
+---------------------+---------------+--------------------------------+
| END_TYPE            | 終了種別      | 5: 正常終了(デフォルト)        |
|                     |               |                                |
|                     |               | 7: 異常終了                    |
|                     |               |                                |
|                     |               | 11: 警告終了                   |
+---------------------+---------------+--------------------------------+
| PATTERN_ID          | Pattern id    |                                |
+---------------------+---------------+--------------------------------+
| ORCHESTRATOR_ID     | Orchestrator  | オーケストレータのID           |
|                     | id            |                                |
|                     |               | 対応表は以下表 5‑8             |
+---------------------+---------------+--------------------------------+
| Name                | Movement名    |                                |
+---------------------+---------------+--------------------------------+
| CALL_CONDUCTOR_ID   | Cond          |                                |
|                     | uctorクラスID |                                |
+---------------------+---------------+--------------------------------+
| CONDUCTOR_NAME      | Conductor名称 |                                |
+---------------------+---------------+--------------------------------+
| CALL_SYMPHONY_ID    | Sym           |                                |
|                     | phonyクラスID |                                |
+---------------------+---------------+--------------------------------+
| SYMPHONY_NAME       | Symphony名称  |                                |
+---------------------+---------------+--------------------------------+
| OPERATION_NO_IDBH   | オペ          |                                |
|                     | レーションID  |                                |
+---------------------+---------------+--------------------------------+
| SKIP_FLAG           | Skip flag     |                                |
+---------------------+---------------+--------------------------------+
| OPERATION_NAME      | オペ          |                                |
|                     | レーション名  |                                |
+---------------------+---------------+--------------------------------+
| note                | 説明          |                                |
+---------------------+---------------+--------------------------------+
| w                   | 幅            |                                |
+---------------------+---------------+--------------------------------+
| x                   | 横            |                                |
+---------------------+---------------+--------------------------------+
| y                   | 縦            |                                |
+---------------------+---------------+--------------------------------+

表 6‑8 Terminal詳細一覧

+---------------------+---------------+--------------------------------+
| **項目キー**        | **パ          | **備考**                       |
|                     | ラメータ名**  |                                |
+=====================+===============+================================+
| case                | Case no       |                                |
+---------------------+---------------+--------------------------------+
| edge                | Node class id |                                |
+---------------------+---------------+--------------------------------+
| id                  | Terminal      |                                |
|                     | class id      |                                |
+---------------------+---------------+--------------------------------+
| targetNode          | 紐付Node      |                                |
+---------------------+---------------+--------------------------------+
| type                | 種別          | in/out                         |
+---------------------+---------------+--------------------------------+
| condition           | 状態          |                                |
+---------------------+---------------+--------------------------------+
| x                   | 横            |                                |
+---------------------+---------------+--------------------------------+
| y                   | 縦            |                                |
+---------------------+---------------+--------------------------------+

表 6‑9 Line詳細一覧

+---------------------+-----------------+-----------------------------+
| **項目キー**        | *               | **備考**                    |
|                     | *パラメータ名** |                             |
+=====================+=================+=============================+
| id                  | Line id         |                             |
+---------------------+-----------------+-----------------------------+
| type                | 種別            | egde                        |
+---------------------+-----------------+-----------------------------+
| inNode              | 内側接続Node    |                             |
+---------------------+-----------------+-----------------------------+
| outTerminal         | 外              |                             |
|                     | 側接続Terminal  |                             |
+---------------------+-----------------+-----------------------------+
| outTerminal         | 内              |                             |
|                     | 側接続Terminal  |                             |
+---------------------+-----------------+-----------------------------+
| outNode             | 外側接続Node    |                             |
+---------------------+-----------------+-----------------------------+

表 6‑10　Conductor実行時ステータスID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | 未実行                                        |
+----------------------+-----------------------------------------------+
| 2                    | 未実行(予約)                                  |
+----------------------+-----------------------------------------------+
| 3                    | 実行中                                        |
+----------------------+-----------------------------------------------+
| 4                    | 実行中(遅延)                                  |
+----------------------+-----------------------------------------------+
| 5                    | 正常終了                                      |
+----------------------+-----------------------------------------------+
| 6                    | 緊急停止                                      |
+----------------------+-----------------------------------------------+
| 7                    | 異常終了                                      |
+----------------------+-----------------------------------------------+
| 8                    | 想定外エラー                                  |
+----------------------+-----------------------------------------------+
| 9                    | 予約取消                                      |
+----------------------+-----------------------------------------------+
| 11                   | 警告終了                                      |
+----------------------+-----------------------------------------------+

.. _filterfilter_dataonly-2:

FILTER・FILTER_DATAONLY
~~~~~~~~~~~~~~~~~~~~~~~

   パラメータで指定した条件に合致したレコードの、列情報（列番号と列名）および、

   通常ステータス（廃止または活性中）の全レコードの行数とレコード内容と列情報を取得します。

   FILTER_DATAONLYを指定した場合は列情報を省略します。

   ※詳細は『標準REST機能の利用』-『FILTER(X-Command)』を参照

   取得列情報は表 6‑4～表 6‑9参照

表 6‑11 パラメータで指定可能な項目

+----------------------+-----------------------------------------------+
| 項目キー             | 対象項目                                      |
+======================+===============================================+
| conductor_name       | Conductor名称                                 |
+----------------------+-----------------------------------------------+
| id                   | ConductorクラスID                             |
+----------------------+-----------------------------------------------+
| note                 | 説明                                          |
+----------------------+-----------------------------------------------+
| ACCESS_AUTH          | アクセス権/アクセス許可ロール                 |
+----------------------+-----------------------------------------------+

..

   | 例） ConductorクラスID が1のレコードを取得したい場合
   | {"id":{"LIST":["1"]}}

   Conductorクラス名称にConductorが含まれるレコードを取得したい場合

   {"conductor_name":{"NORMAL":"Conductor"}}

   ConductorクラスIDが1～3のレコードを取得したい場合

   {"id":{"RANGE":{"START":"1","END":"3"}}}

+-----------------------------------------------------------------------+
| **例）FILTER取得例**                                                  |
+=======================================================================+
| {…                                                                    |
|                                                                       |
|    {                                                                  |
|                                                                       |
| "edittype": "実行処理種別",                                           |
|                                                                       |
| "disuse": "廃止",                                                     |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "conductor_name":"Conductor名称",                                     |
|                                                                       |
| "id":"ConductorクラスID",                                             |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "LUT4U":"更新用の最終更新日時",                                       |
|                                                                       |
| "ACCESS_AUTH":"アクセス権/アクセス許可ロール",                        |
|                                                                       |
| "NOTICE_INFO":"通知設定"                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "config": {                                                           |
|                                                                       |
| "editorVersion":"Editor情報",                                         |
|                                                                       |
| "nodeNumber":" Node数",                                               |
|                                                                       |
| "terminalNumber":"Terminal数",                                        |
|                                                                       |
| "edgeNumber":"Edge数"                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node": {                                                             |
|                                                                       |
| "h":"高さ",                                                           |
|                                                                       |
| "id":" Node class id",                                                |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "case":"Case no",                                                     |
|                                                                       |
| "edge":" 紐付Line",                                                   |
|                                                                       |
| "id":"Terminal class id",                                             |
|                                                                       |
| "targetNode":"紐付Node"                                               |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "condition":"状態",                                                   |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "END_TYPE":"終了種別",                                                |
|                                                                       |
| "PATTERN_ID":"Pattern id",                                            |
|                                                                       |
| "ORCHESTRATOR_ID":"Orchestrator id",                                  |
|                                                                       |
| "Name":" Movement名",                                                 |
|                                                                       |
| "CALL_CONDUCTOR_ID":"ConductorクラスID",                              |
|                                                                       |
| "CONDUCTOR_NAME":"Conductor名称",                                     |
|                                                                       |
| "CALL_SYMPHONY_ID":"SymphonyクラスID",                                |
|                                                                       |
| "SYMPHONY_NAME":"Symphony名称",                                       |
|                                                                       |
| "OPERATION_NO_IDBH:" オペレーションID",                               |
|                                                                       |
| "SKIP_FLAG":"Skip flag",                                              |
|                                                                       |
| "OPERATION_NAME":"オペレーション名",                                  |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "w":"幅",                                                             |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "line": {                                                             |
|                                                                       |
| "id":"Line id",                                                       |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "inNode":"内側接続Node",                                              |
|                                                                       |
| "outTerminal":"外側接続Terminal "                                     |
|                                                                       |
| "inTerminal":"内側接続Terminal ",                                     |
|                                                                       |
| "outNode ":"外側接続Node "                                            |
|                                                                       |
| }                                                                     |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    1:{                                                                |
|                                                                       |
|    "edittype":null,                                                   |
|                                                                       |
|    "disuse":"",                                                       |
|                                                                       |
|    "conductor":{                                                      |
|                                                                       |
|    conductor_name:Conductor_002,                                      |
|                                                                       |
|    id:7,                                                              |
|                                                                       |
|    note:null,                                                         |
|                                                                       |
|    LUT4U:T_20210629121745463936,                                      |
|                                                                       |
|    ACCESS_AUTH:"",                                                    |
|                                                                       |
|    NOTICE_INFO: {                                                     |
|                                                                       |
|    "1":"3,4,5,11,6,7,8"                                               |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    "config:{                                                          |
|                                                                       |
|    "editorVersion":"1.0.2",                                           |
|                                                                       |
|    nodeNumber:4,                                                      |
|                                                                       |
|    terminalNumber:5,                                                  |
|                                                                       |
|    edgeNumber:3                                                       |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    node-1:{                                                           |
|                                                                       |
|    "h":"58",                                                          |
|                                                                       |
|    "id":"node-1",                                                     |
|                                                                       |
|    "terminal":{                                                       |
|                                                                       |
|    "terminal-1":{                                                     |
|                                                                       |
|    "case":"",                                                         |
|                                                                       |
|    "edge":"line-1",                                                   |
|                                                                       |
|    "id":"terminal-1",                                                 |
|                                                                       |
|    "targetNode":"node-3",                                             |
|                                                                       |
|    "type":"out",                                                      |
|                                                                       |
|    "condition":[],                                                    |
|                                                                       |
|    "x":"7666",                                                        |
|                                                                       |
|    "y":"8000"                                                         |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    "type":"start",                                                    |
|                                                                       |
|    "PATTERN_ID":"",                                                   |
|                                                                       |
|    "ORCHESTRATOR_ID":"",                                              |
|                                                                       |
|    "Name":"",                                                         |
|                                                                       |
|    "CALL_CONDUCTOR_ID":"",                                            |
|                                                                       |
|    "CONDUCTOR_NAME":"",                                               |
|                                                                       |
|    "CALL_SYMPHONY_ID":"",                                             |
|                                                                       |
|    "SYMPHONY_NAME":"",                                                |
|                                                                       |
|    "OPERATION_NO_IDBH":"",                                            |
|                                                                       |
|    "SKIP_FLAG":"",                                                    |
|                                                                       |
|    "OPERATION_NAME":"",                                               |
|                                                                       |
|    "note":null,                                                       |
|                                                                       |
|    "w":"198",                                                         |
|                                                                       |
|    "x":"7485",                                                        |
|                                                                       |
|    "y":"7971"                                                         |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    node-2:{                                                           |
|                                                                       |
|    "h":"58",                                                          |
|                                                                       |
|    "id":"node-2",                                                     |
|                                                                       |
|    "terminal":{                                                       |
|                                                                       |
|    "terminal-2":{                                                     |
|                                                                       |
|    "case":"",                                                         |
|                                                                       |
|    "edge":"line-2",                                                   |
|                                                                       |
|    "id":"terminal-2",                                                 |
|                                                                       |
|    "targetNode":"node-3",                                             |
|                                                                       |
|    "type":"in",                                                       |
|                                                                       |
|    "condition":[],                                                    |
|                                                                       |
|    "x":"8334",                                                        |
|                                                                       |
|    "y":"8000"                                                         |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    "type":"end",                                                      |
|                                                                       |
|    "PATTERN_ID":"",                                                   |
|                                                                       |
|    "ORCHESTRATOR_ID":"",                                              |
|                                                                       |
|    "Name":"",                                                         |
|                                                                       |
|    "CALL_CONDUCTOR_ID":"",                                            |
|                                                                       |
|    "CONDUCTOR_NAME":"",                                               |
|                                                                       |
|    "CALL_SYMPHONY_ID":"",                                             |
|                                                                       |
|    "SYMPHONY_NAME":"",                                                |
|                                                                       |
|    "OPERATION_NO_IDBH":"",                                            |
|                                                                       |
|    "SKIP_FLAG":"",                                                    |
|                                                                       |
|    "OPERATION_NAME":"",                                               |
|                                                                       |
|    "note":null,                                                       |
|                                                                       |
|    "w":"198",                                                         |
|                                                                       |
|    "x":"8317",                                                        |
|                                                                       |
|    "y":"7971"                                                         |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    node-3:{                                                           |
|                                                                       |
|    "h":"58",                                                          |
|                                                                       |
|    "id":"node-3",                                                     |
|                                                                       |
|    "terminal":{                                                       |
|                                                                       |
|    "terminal-3":{                                                     |
|                                                                       |
|    "case":"",                                                         |
|                                                                       |
|    "edge":"line-1",                                                   |
|                                                                       |
|    "id":"terminal-3",                                                 |
|                                                                       |
|    "targetNode":"node-1",                                             |
|                                                                       |
|    "type":"in",                                                       |
|                                                                       |
|    "condition":[],                                                    |
|                                                                       |
|    "x":"7888",                                                        |
|                                                                       |
|    "y":"8000"                                                         |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    "terminal-4":{                                                     |
|                                                                       |
|    "case":"",                                                         |
|                                                                       |
|    "edge":"line-2",                                                   |
|                                                                       |
|    "id":"terminal-4",                                                 |
|                                                                       |
|    "targetNode":"node-2",                                             |
|                                                                       |
|    "type":"out",                                                      |
|                                                                       |
|    "condition":[],                                                    |
|                                                                       |
|    "x":"8099",                                                        |
|                                                                       |
|    "y":"8000"                                                         |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    "type":"movement",                                                 |
|                                                                       |
|    "PATTERN_ID":"1",                                                  |
|                                                                       |
|    "ORCHESTRATOR_ID":"3",                                             |
|                                                                       |
|    "Name":"move1",                                                    |
|                                                                       |
|    "CALL_CONDUCTOR_ID":"",                                            |
|                                                                       |
|    "CONDUCTOR_NAME":"",                                               |
|                                                                       |
|    "CALL_SYMPHONY_ID":"",                                             |
|                                                                       |
|    "SYMPHONY_NAME":"",                                                |
|                                                                       |
|    "OPERATION_NO_IDBH":"",                                            |
|                                                                       |
|    "SKIP_FLAG":"0",                                                   |
|                                                                       |
|    "OPERATION_NAME":"",                                               |
|                                                                       |
|    "note":null,                                                       |
|                                                                       |
|    "w":"245",                                                         |
|                                                                       |
|    "x":"7871",                                                        |
|                                                                       |
|    "y":"7978"                                                         |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    line-1:{                                                           |
|                                                                       |
|    "id":"line-1",                                                     |
|                                                                       |
|    "type":"egde",                                                     |
|                                                                       |
|    "inNode":"node-3",                                                 |
|                                                                       |
|    "outTerminal":"terminal-1",                                        |
|                                                                       |
|    "inTerminal":"terminal-3",                                         |
|                                                                       |
|    "outNode":"node-1"                                                 |
|                                                                       |
|    },                                                                 |
|                                                                       |
|    line-2:{                                                           |
|                                                                       |
|    "id":"line-2",                                                     |
|                                                                       |
|    "type":"egde",                                                     |
|                                                                       |
|    "inTerminal":"terminal-2",                                         |
|                                                                       |
|    "outNode":"node-3",                                                |
|                                                                       |
|    "inNode":"node-2",                                                 |
|                                                                       |
|    "outTerminal":"terminal-4"                                         |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    }                                                                  |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   NodeのORCHESTRATOR_IDについては以下の表を参照

表 6‑12 ORCHESTRATOR_ID(オーケストレータID)対応表

+-----------------+----------------------------------------------------+
| ID              | ステータス                                         |
+=================+====================================================+
| 3               | Ansible Legacy                                     |
+-----------------+----------------------------------------------------+
| 4               | Ansible Pioneer                                    |
+-----------------+----------------------------------------------------+
| 5               | Ansible Legacy Role                                |
+-----------------+----------------------------------------------------+
| 10              | Terraform                                          |
+-----------------+----------------------------------------------------+

..

   NodeのEND_TYPEについては以下の表を参照

表 6‑13 END_TYPE(終了種別)対応表

+-----------------+----------------------------------------------------+
| ID              | ステータス                                         |
+=================+====================================================+
| 5               | 正常終了                                           |
+-----------------+----------------------------------------------------+
| 7               | 異常終了                                           |
+-----------------+----------------------------------------------------+
| 11              | 警告終了                                           |
+-----------------+----------------------------------------------------+

.. _edit-2:

EDIT
~~~~

   Conductorクラスの登録、更新、廃止、復活を行います。

・HTTPヘッダ

表 6‑14 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| Method                         | POST                                |
+--------------------------------+-------------------------------------+
| X-Command                      | EDIT                                |
+--------------------------------+-------------------------------------+

・パラメータ

2) 指定形式

..

   各実行種別のパラメータ指定項目は以下の、パラメータ指定項目を参照してください。

   項目キーLUT4Uについては、[更新]、[廃止]、[復活]指定時、

X-Command：FILTERで取得した、【更新用の最終更新日時】をセットしてください。

このデータによって、追い越し更新を防止しています。

【更新用の最終更新日時】は、“\ *T*\ \_“で始まっています。

+-----------------------------------------------------------------------+
| **　パラメータ指定項目（登録/更新）**                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "edittype": "実行処理種別：<登録 or 更新>",                           |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "conductor_name":"Conductor名称",                                     |
|                                                                       |
| "id":" ConductorクラスID",                                            |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "LUT4U":"更新用の最終更新日時",                                       |
|                                                                       |
| "ACCESS_AUTH":"アクセス権/アクセス許可ロール",                        |
|                                                                       |
| "NOTICE_INFO":"通知設定",                                             |
|                                                                       |
| },                                                                    |
|                                                                       |
| "config": {                                                           |
|                                                                       |
| "editorVersion":"Editor情報",                                         |
|                                                                       |
| "nodeNumber":" Node数",                                               |
|                                                                       |
| "terminalNumber":"Terminal数",                                        |
|                                                                       |
| "edgeNumber":"Edge数"                                                 |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node-1": {                                                           |
|                                                                       |
| "h":"高さ",                                                           |
|                                                                       |
| "id":" Node class id",                                                |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "terminal-1": {                                                       |
|                                                                       |
| "case":"Case no",                                                     |
|                                                                       |
| "edge":" 紐付Line",                                                   |
|                                                                       |
| "id":"Terminal class id",                                             |
|                                                                       |
| "targetNode":"紐付Node"                                               |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "condition":"状態",                                                   |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| 　　 **・・・Terminal数分繰り返し追加(terminal-1, terminal-2…         |
| terminal-n)・・・・**                                                 |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "END_TYPE":"終了種別",                                                |
|                                                                       |
| "PATTERN_ID":"Pattern id",                                            |
|                                                                       |
| "ORCHESTRATOR_ID":"Orchestrator id",                                  |
|                                                                       |
| "Name":" Movement名",                                                 |
|                                                                       |
| "CALL_CONDUCTOR_ID":"ConductorクラスID",                              |
|                                                                       |
| "CONDUCTOR_NAME":"Conductor名称",                                     |
|                                                                       |
| "CALL_SYMPHONY_ID":"SymphonyクラスID",                                |
|                                                                       |
| "SYMPHONY_NAME":"Symphony名称",                                       |
|                                                                       |
| "OPERATION_NO_IDBH:" オペレーションID",                               |
|                                                                       |
| "SKIP_FLAG":"Skip flag",                                              |
|                                                                       |
| "OPERATION_NAME":"オペレーション名",                                  |
|                                                                       |
| "note":"説明",                                                        |
|                                                                       |
| "w":"幅",                                                             |
|                                                                       |
| "x":"横",                                                             |
|                                                                       |
| "y":"縦"                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| **・・・Node数分繰り返し追加(node-1,node-2…node-n)・・・・**          |
|                                                                       |
| "line-1": {                                                           |
|                                                                       |
| "id":"Line id",                                                       |
|                                                                       |
| "type":"種別",                                                        |
|                                                                       |
| "inNode":"内側接続Node",                                              |
|                                                                       |
| "outTerminal":"外側接続Terminal "                                     |
|                                                                       |
| "inTerminal":"内側接続Terminal ",                                     |
|                                                                       |
| "outNode ":"外側接続Node "                                            |
|                                                                       |
| },                                                                    |
|                                                                       |
| **・・・Line数分繰り返し追加(line-1,line-2…line-n)・・・・**          |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| **　パラメータ指定項目（廃止/復活）**                                 |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "edittype": "実行処理種別：<廃止 or 復活>",                           |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "id":" ConductorクラスID",                                            |
|                                                                       |
| "LUT4U":"更新用の最終更新日時"                                        |
|                                                                       |
| },                                                                    |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

※Method：GET、X-Command：FILTERで取得した、【更新用の最終更新日時】をセット

してください。このデータによって、追い越し更新を防止しています。

【更新用の最終更新日時】は、“\ *T*\ \_“で始まっています。

+-----------------------------------------------------------------------+
| **例）JSON記述例：複数の実行処理種別対象とした場合**                  |
+=======================================================================+
|    {"0":{                                                             |
|                                                                       |
| "edittype": "登録",                                                   |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "conductor_name":"Conductor_001",                                     |
|                                                                       |
| "note":null,                                                          |
|                                                                       |
| "ACCESS_AUTH":null,                                                   |
|                                                                       |
| "NOTICE_INFO": {                                                      |
|                                                                       |
| "1": "3,5,11,7,8"                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| },                                                                    |
|                                                                       |
| "config": {                                                           |
|                                                                       |
| "editorVersion":"1.0.2",                                              |
|                                                                       |
| "nodeNumber":4,                                                       |
|                                                                       |
| "terminalNumber":5,                                                   |
|                                                                       |
| "edgeNumber":3                                                        |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node-1": {                                                           |
|                                                                       |
| "h":58,                                                               |
|                                                                       |
| "id":" node-1",                                                       |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "terminal-1": {                                                       |
|                                                                       |
| "edge":" line-1",                                                     |
|                                                                       |
| "id":" terminal-1",                                                   |
|                                                                       |
| "targetNode":" node-3"                                                |
|                                                                       |
| "type":"out",                                                         |
|                                                                       |
| "x":"7666",                                                           |
|                                                                       |
| "y":"8000"                                                            |
|                                                                       |
| },                                                                    |
|                                                                       |
| "type":"start",                                                       |
|                                                                       |
| "note":null,                                                          |
|                                                                       |
| "w":198,                                                              |
|                                                                       |
| "x":7485,                                                             |
|                                                                       |
| "y":7971                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node-2": {                                                           |
|                                                                       |
| "h":58,                                                               |
|                                                                       |
| "id":" node-2",                                                       |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "terminal-2": {                                                       |
|                                                                       |
| "edge":" line-2",                                                     |
|                                                                       |
| "id":" terminal-2",                                                   |
|                                                                       |
| "targetNode":" node-3"                                                |
|                                                                       |
| "type":"in",                                                          |
|                                                                       |
| "x":"8334",                                                           |
|                                                                       |
| "y":"8000"                                                            |
|                                                                       |
| },                                                                    |
|                                                                       |
| "type":"end",                                                         |
|                                                                       |
| "END_TYPE":"5",                                                       |
|                                                                       |
| "note":null,                                                          |
|                                                                       |
| "w":198,                                                              |
|                                                                       |
| "x":8317,                                                             |
|                                                                       |
| "y":7971                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node-3": {                                                           |
|                                                                       |
| "h":58,                                                               |
|                                                                       |
| "id":" node-3",                                                       |
|                                                                       |
| "terminal":{                                                          |
|                                                                       |
| "terminal-3": {                                                       |
|                                                                       |
| "edge":" line-1",                                                     |
|                                                                       |
| "id":" terminal-3",                                                   |
|                                                                       |
| "targetNode":" node-1"                                                |
|                                                                       |
| "type":"in",                                                          |
|                                                                       |
| "x":"7888",                                                           |
|                                                                       |
| "y":"8000"                                                            |
|                                                                       |
| },                                                                    |
|                                                                       |
| "terminal-4": {                                                       |
|                                                                       |
| "edge":" line-2",                                                     |
|                                                                       |
| "id":" terminal-4",                                                   |
|                                                                       |
| "targetNode":" node-2"                                                |
|                                                                       |
| "type":"out",                                                         |
|                                                                       |
| "x":"8099",                                                           |
|                                                                       |
| "y":"8000"                                                            |
|                                                                       |
| },                                                                    |
|                                                                       |
| "type":"movement",                                                    |
|                                                                       |
| "PATTERN_ID":"1",                                                     |
|                                                                       |
| "ORCHESTRATOR_ID ":"3",                                               |
|                                                                       |
| "Name ":"move1",                                                      |
|                                                                       |
| "OPERATION_NO_IDBH":null,                                             |
|                                                                       |
| "SKIP_FLAG ":"0",                                                     |
|                                                                       |
| "OPERATION_NAME":"",                                                  |
|                                                                       |
| "note":null,                                                          |
|                                                                       |
| "w":198,                                                              |
|                                                                       |
| "x":8317,                                                             |
|                                                                       |
| "y":7971                                                              |
|                                                                       |
| },                                                                    |
|                                                                       |
| "1":{                                                                 |
|                                                                       |
| "edittype": "廃止",                                                   |
|                                                                       |
| "conductor": {                                                        |
|                                                                       |
| "id":"2",                                                             |
|                                                                       |
| "LUT4U": "T_20191224135449793941"                                     |
|                                                                       |
|    }                                                                  |
|                                                                       |
|    }                                                                  |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

また、WebのConductorクラス編集画面からjsonファイルを保存して更新、登録、廃止、復活に流用することができます。

   .. image:: ./general_operations/image3.png
      :width: 4.38806in
      :height: 2.23924in

・レスポンス

登録・更新のRAW出力

表 6‑15 Keyパラメータ一覧

+--------------+--------------+----------------------------------------+
| **key**      | **値の型**   | **　**                                 |
+==============+==============+========================================+
| 0            | 文字列       | 結果コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 1            | 文字列       | 詳細コード(別表を参照)                 |
+--------------+--------------+----------------------------------------+
| 2            | 文字列       | ConnductorクラスID                     |
+--------------+--------------+----------------------------------------+
| 3            | 文字列       | エラーメッセージ                       |
+--------------+--------------+----------------------------------------+

..

   各レコードの処理結果について、廃止・復活時のRAW出力は『標準REST機能の利用』-『EDIT(X-Command)』を参照。

Conductor作業実行を対象としたRestAPI
------------------------------------

   Conductorの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Conductor]の、[Conductor作業実行]メニュー、[Conductor作業確認]メニューに相当する操作です。

表 6‑14　対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Conductor          | Conductor作業実行     | 2100180004             |
+--------------------+-----------------------+------------------------+
|                    | Conductor作業確認     | 2100180005             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-10:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   6‑16　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 6‑15 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | EXECUTE                                                 |
|            |                                                         |
|            | CANCEL                                                  |
|            |                                                         |
|            | SCRAM                                                   |
|            |                                                         |
|            | RELEASE                                                 |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

表 6‑16　X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| EXECUTE  | Co                            | Cond          | 21       |
|          | nductorの作業実行を行います。 | uctor作業実行 | 00180004 |
+----------+-------------------------------+---------------+----------+
| CANCEL   | Conduc                        | Cond          | 21       |
|          | torの予約取り消しを行います。 | uctor作業確認 | 00180005 |
+----------+-------------------------------+---------------+----------+
| SCRAM    | Co                            | Cond          | 21       |
|          | nductorの緊急停止を行います。 | uctor作業確認 | 00180005 |
+----------+-------------------------------+---------------+----------+
| RELEASE  | Conducto                      | Cond          | 21       |
|          | rの一時停止の解除を行います。 | uctor作業確認 | 00180005 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _レスポンスの項目-2:

レスポンスの項目
~~~~~~~~~~~~~~~~

以下では、それぞれのX-comannd実行時のレスポンス項目についての説明を行います。

表 6‑17　レスポンス項目一覧

+-----------------------+----------------------------------------------+
| 項目名                | 備考                                         |
+=======================+==============================================+
| CONDUCTOR_INSTANCE_ID | CONDUCTORインスタンスに対する操作に使用      |
+-----------------------+----------------------------------------------+
| NODE_INSTANCE_NO      | RELEASE時のみ使用                            |
+-----------------------+----------------------------------------------+
| RESULTCODE            | コマンド実行の成否のコード                   |
|                       |                                              |
|                       |    000：正常終了                             |
|                       |                                              |
|                       |    001：実行不可                             |
|                       |                                              |
|                       |    002：予約取消不可                         |
|                       |                                              |
|                       |    003：緊急停止不可                         |
|                       |                                              |
|                       |    004：一時停止解除不可                     |
+-----------------------+----------------------------------------------+
| RESULTINFO            | 詳細情報                                     |
+-----------------------+----------------------------------------------+

.. _execute-5:

EXECUTE
~~~~~~~

   Conductorクラスとオペレーションを指定して、作業実行を行います。予約日時の指定や、Conductor

   クラスに登録されているMovementごとに、スキップ、オペレーションIDの個別指定ができます。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

表 6‑18　オペレーションID　個別指定パラメータ一覧

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| CONDUCTOR_CLASS_NO   | ConductorクラスID                             |
+----------------------+-----------------------------------------------+
| OPERATION_ID         | オペレーションID                              |
+----------------------+-----------------------------------------------+
| PRESERVE_DATETIME    | 予約日時（YYYY/MM/DD ｔｔ:ｍｍ）              |
+----------------------+-----------------------------------------------+
| OPTION               | 対象ノード                                    |
|                      | 毎に、スキップ、オペレーションIDの個別指定。  |
|                      |                                               |
|                      | | {                                           |
|                      | | “<Node class id>":{                         |
|                      |                                               |
|                      | "OPERATION_ID":<オペレーションID>,            |
|                      |                                               |
|                      | "SKIP_FLAG":<スキップの有無> ※1               |
|                      |                                               |
|                      | },                                            |
|                      |                                               |
|                      | “<Nodeid>":{                                  |
|                      |                                               |
|                      | ・・・（中略）・・・                          |
|                      |                                               |
|                      | },                                            |
|                      |                                               |
|                      | }                                             |
|                      |                                               |
|                      | ※1 　1：スキップ                              |
|                      |                                               |
|                      | 空：スキップしない                            |
+----------------------+-----------------------------------------------+

+-----------------------------------------------------------------------+
| 1）EXECUTE　Json記述例                                                |
+=======================================================================+
| ConductorクラスIDが1、オペレーションIDが1001、予約日時が2016/01/01    |
| 00:00の場合                                                           |
|                                                                       |
| ▽Json形式で記述                                                       |
|                                                                       |
| {                                                                     |
|                                                                       |
| "CONDUCTOR_CLASS_NO": 1,                                              |
|                                                                       |
| "OPERATION_ID": 1001,                                                 |
|                                                                       |
| "PRESERVE_DATETIME": "2016/01/01 00:00",                              |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

**図 6.1-1 EXECUTE　Json記述例**

+-----------------------------------------------------------------------+
| 2）EXECUTE　Json記述例(オペレーション、スキップの個別指定)            |
+=======================================================================+
| ConductorクラスIDが1、オペレーションIDが1001、                        |
|                                                                       |
| movement(node-3)へオペレーションID                                    |
| 2001を指定、movement(node-4)をSKIPする場合                            |
|                                                                       |
| ▽Json形式で記述                                                       |
|                                                                       |
| {                                                                     |
|                                                                       |
| "CONDUCTOR_CLASS_NO": 1,                                              |
|                                                                       |
| "OPERATION_ID": 1001,                                                 |
|                                                                       |
| "OPTION":{                                                            |
|                                                                       |
| "node-3":{                                                            |
|                                                                       |
| "OPERATION_ID":2001                                                   |
|                                                                       |
| },                                                                    |
|                                                                       |
| "node-4":{                                                            |
|                                                                       |
| "SKIP_FLAG":1                                                         |
|                                                                       |
| }}                                                                    |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

**図 6.1-2 EXECUTE　Json記述例 (個別指定)**

   　・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "実行の成否",                                               |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONDUCTOR_INSTANCE_ID": "実行No ",※                                  |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ※実行後のインスタンスを操作（INFO,CANCEL、SCRAM、RELEASE）する際に使用します。

.. _cancel-1:

CANCEL
~~~~~~

   予約日時が登録されているConductorのインスタンスIDを指定して、予約実行をキャンセルします。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 6‑19　 Conductor実行予約キャンセルパラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| CONDUCTOR_INSTANCE_ID          | ConductorインスタンスID※            |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| " CONDUCTOR_INSTANCE_ID": " Conductor実行時のインスタンスのID ",      |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

.. _scram-1:

SCRAM
~~~~~

   実行されているConductorのインスタンスIDを指定して、緊急停止します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 6‑20 Conductor実行処理の緊急停止パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| CONDUCTOR_INSTANCE_ID          | ConductorインスタンスID※            |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| " CONDUCTOR_INSTANCE_ID": " Conductor実行時のインスタンスのID ",      |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

.. _release-1:

RELEASE
~~~~~~~

   ConductorのインスタンスIDとNodeインスタンスIDを指定して、一時停止が設定されているポイントを解除します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 6‑21 Conductor実行処理の一時停止解除パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| CONDUCTOR_INSTANCE_ID          | ConductorインスタンスID※1           |
+--------------------------------+-------------------------------------+
| NODE_INSTANCE_ID               | NodeインスタンスID※2                |
+--------------------------------+-------------------------------------+

..

   ※1 EXECUTEの返り値で取得したものです。

   ※2 NodeのインスタンスIDの取得について、『 6.3
   Conductor作業確認を対象としたRestAPI』を参照。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。項目について以下参照。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONDUCTOR_INSTANCE_ID": "Conductor実行時のインスタンスのID",         |
|                                                                       |
| " NODE_INSTANCE_NO": "『Conductor pause』のNodeインスタンスID",       |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

Conductor作業確認を対象としたRestAPI
------------------------------------

   Conductorの操作をRestAPIで行うことができます。

   利用可能な機能は、メニューグループ[Conductor]の、[Conductor作業実行]メニュー、[Conductor作業確認]メニューに相当する操作です。

表 6‑22　対象メニュー一覧

+--------------------+-----------------------+------------------------+
| メニューグループ   | メニュー名            | メニューID             |
+====================+=======================+========================+
| Conductor          | Conductor作業確認     | 2100180005             |
+--------------------+-----------------------+------------------------+

.. _リクエストの形式-11:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『**\ 表
   5‑19　X-Commandに指定可能なパラメータ一覧\ **表
   6‑24　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 6‑23 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | の1つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 6‑24　X-Commandに指定可能なパラメータ一覧

+----------+-------------------------------+---------------+----------+
| X        | 説明                          | 対象画面      | メ       |
| -Command |                               |               | ニューID |
+==========+===============================+===============+==========+
| INFO     | Conductorの状態確認           | Cond          | 21       |
|          | をし、ステータスを返します。  | uctor作業確認 | 00180005 |
+----------+-------------------------------+---------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _レスポンスの項目-3:

レスポンスの項目
~~~~~~~~~~~~~~~~

以下では、それぞれのX-comannd実行時のレスポンス項目についての説明を行います。

表 6‑25　レスポンス項目一覧

+-----------------------+----------------------------------------------+
| 項目名                | 備考                                         |
+=======================+==============================================+
| CONDUCTOR_INSTANCE_ID | CONDUCTORインスタンスに対する操作に使用      |
+-----------------------+----------------------------------------------+
| RESULTCODE            | コマンド実行の成否のコード                   |
|                       |                                              |
|                       |    000：正常終了                             |
+-----------------------+----------------------------------------------+
| RESULTINFO            | 詳細情報                                     |
+-----------------------+----------------------------------------------+

.. _info-6:

INFO
~~~~

   Conductor実行時のインスタンスIDを指定して、実行時の情報を取得します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 6‑26　Conductor実行情報取得パラメータ表

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| CONDUCTOR_INSTANCE_ID          | ConductorインスタンスID※            |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONDUCTOR_INSTANCE_INFO": {                                          |
|                                                                       |
| "CONDUCTOR_INSTANCE_ID": 1,                                           |
|                                                                       |
| ・・・（中略）項目は以下①参照・・・                                   |
|                                                                       |
| },                                                                    |
|                                                                       |
| "NODE_INFO": [                                                        |
|                                                                       |
| "node-1": {                                                           |
|                                                                       |
| "NODE_NAME": "11",                                                    |
|                                                                       |
| ・・・（中略）項目は以下②参照・・・                                   |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| 　　　　　　・・・・                                                  |
|                                                                       |
| ],                                                                    |
|                                                                       |
| "RESULTCODE": "000",                                                  |
|                                                                       |
| "RESULTINFO": ""                                                      |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

　　　

#. CONDUCTOR_INSTANCE_INFOに格納されるConductorインスタンスの情報配列

表 6‑27　インスタンス配列表

+---------------------------+------------------------------------------+
| キー                      | 内容                                     |
+===========================+==========================================+
| CONDUCTOR_INSTANCE_ID     | ConductorインスタンスID                  |
+---------------------------+------------------------------------------+
| CONDUCTOR_NAME            | Conductor名称                            |
+---------------------------+------------------------------------------+
| STATUS_ID                 | 実行時ステータス　詳細は以下　表 6‑      |
+---------------------------+------------------------------------------+
| EXECUTION_USER            | 実行ユーザー                             |
+---------------------------+------------------------------------------+
| ABORT_EXECUTE_FLAG        | 緊急                                     |
|                           | 停止発令フラグ　未発令：１　発令済み：２ |
+---------------------------+------------------------------------------+
| OPERATION_NO_IDBH         | 登録オペレーションID                     |
+---------------------------+------------------------------------------+
| OPERATION_NAME            | 登録オペレーション名                     |
+---------------------------+------------------------------------------+
| TIME_BOOK                 | 予約日時                                 |
+---------------------------+------------------------------------------+
| TIME_START                | 開始日時                                 |
+---------------------------+------------------------------------------+
| TIME_END                  | 終了日時                                 |
+---------------------------+------------------------------------------+
| NOTE                      | 備考                                     |
+---------------------------+------------------------------------------+

2. NODE_INFOに格納されるNodeインスタンス情報配列

表 6‑28　Nodeインスタンス情報表

+---------------------------+------------------------------------------+
| キー                      | 内容                                     |
+===========================+==========================================+
| NODE_NAME                 | Node名　                                 |
+---------------------------+------------------------------------------+
| NODE_INSTANCE_NO          | NodeインスタンスNo                       |
+---------------------------+------------------------------------------+
| NODE_TYPE_ID              | NodeタイプID 詳細は以下　表 6‑3          |
+---------------------------+------------------------------------------+
| STATUS                    | Nodeのステータス 詳細は以下　表 6‑       |
+---------------------------+------------------------------------------+
| STATUS_FILE               | Mo                                       |
|                           | vementで出力されたステータスファイルの値 |
+---------------------------+------------------------------------------+
| SKIP                      | スキップが設定されている　：2            |
+---------------------------+------------------------------------------+
| TIME_START                | 開始日時                                 |
+---------------------------+------------------------------------------+
| TIME_END                  | 終了日時                                 |
+---------------------------+------------------------------------------+
| OPERATION_ID              | 個別に指定したオペレーションID           |
+---------------------------+------------------------------------------+
| OPERATION_NAME            | 個別に指定したオペレーション名           |
+---------------------------+------------------------------------------+
| NOTE                      | 備考                                     |
+---------------------------+------------------------------------------+

3. ID対応表

表 6‑29　Conductorインスタンスの実行時ステータスID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | 未実行                                        |
+----------------------+-----------------------------------------------+
| 2                    | 未実行(予約)                                  |
+----------------------+-----------------------------------------------+
| 3                    | 実行中                                        |
+----------------------+-----------------------------------------------+
| 4                    | 実行中(遅延)                                  |
+----------------------+-----------------------------------------------+
| 5                    | 正常終了                                      |
+----------------------+-----------------------------------------------+
| 6                    | 緊急停止                                      |
+----------------------+-----------------------------------------------+
| 7                    | 異常終了                                      |
+----------------------+-----------------------------------------------+
| 8                    | 想定外エラー                                  |
+----------------------+-----------------------------------------------+
| 9                    | 予約取消                                      |
+----------------------+-----------------------------------------------+
| 11                   | 警告終了                                      |
+----------------------+-----------------------------------------------+

表 6‑30　オーケストレータのID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 3                    | Ansible Legacy                                |
+----------------------+-----------------------------------------------+
| 4                    | Ansible Pioneer                               |
+----------------------+-----------------------------------------------+
| 5                    | Ansible Legacy Role                           |
+----------------------+-----------------------------------------------+
| 10                   | Terraform                                     |
+----------------------+-----------------------------------------------+

..

   表 6‑31　NodeタイプID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | Conductor start                               |
+----------------------+-----------------------------------------------+
| 2                    | Conductor end                                 |
+----------------------+-----------------------------------------------+
| 3                    | Movement                                      |
+----------------------+-----------------------------------------------+
| 4                    | Conductor call                                |
+----------------------+-----------------------------------------------+
| 5                    | Parallel branch                               |
+----------------------+-----------------------------------------------+
| 6                    | Conditional branch                            |
+----------------------+-----------------------------------------------+
| 7                    | Parallel merge                                |
+----------------------+-----------------------------------------------+
| 8                    | Conductor pause                               |
+----------------------+-----------------------------------------------+
| 10                   | Symphony call                                 |
+----------------------+-----------------------------------------------+
| 11                   | Status file banch                             |
+----------------------+-----------------------------------------------+

表 6‑32 Nodeインスタンスの実行時ステータスID対応表

+----------------------+-----------------------------------------------+
| ID                   | ステータス                                    |
+======================+===============================================+
| 1                    | 未実行                                        |
+----------------------+-----------------------------------------------+
| 2                    | 準備中                                        |
+----------------------+-----------------------------------------------+
| 3                    | 実行中                                        |
+----------------------+-----------------------------------------------+
| 4                    | 実行中(遅延)                                  |
+----------------------+-----------------------------------------------+
| 5                    | 実行完了                                      |
+----------------------+-----------------------------------------------+
| 6                    | 異常終了                                      |
+----------------------+-----------------------------------------------+
| 7                    | 緊急停止                                      |
+----------------------+-----------------------------------------------+
| 8                    | 保留中                                        |
+----------------------+-----------------------------------------------+
| 9                    | 正常終了                                      |
+----------------------+-----------------------------------------------+
| 10                   | 準備エラー                                    |
+----------------------+-----------------------------------------------+
| 11                   | 想定外エラー                                  |
+----------------------+-----------------------------------------------+
| 12                   | Skip完了                                      |
+----------------------+-----------------------------------------------+
| 13                   | Skip後保留中                                  |
+----------------------+-----------------------------------------------+
| 14                   | Skip終了                                      |
+----------------------+-----------------------------------------------+
| 15                   | 警告終了                                      |
+----------------------+-----------------------------------------------+

Conductor作業一覧を対象としたRestAPI
------------------------------------

.. _リクエストの形式-12:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑19　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 6-33 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFO                                                    |
|            |                                                         |
|            | FILTER                                                  |
|            |                                                         |
|            | FILTER_DATAONLY                                         |
|            |                                                         |
|            | EDIT                                                    |
|            |                                                         |
|            | DOWNLOAD                                                |
|            |                                                         |
|            | の4つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 6-34　X-Commandに指定可能なパラメータ一覧

+---------------+---------------------------+--------------+----------+
| X-Command     | 説明                      | 対象画面     | メ       |
|               |                           |              | ニューID |
+===============+===========================+==============+==========+
| INFO          | Conductor作業一覧の       | Condu        | 21       |
|               | 列情報のみを取得します。  | ctor作業一覧 | 00180006 |
+---------------+---------------------------+--------------+----------+
| FILTER        | Conductor作業一覧         | Condu        | 21       |
|               | のパラメータに一致したレ  | ctor作業一覧 | 00180006 |
| FI            | コードの参照を行います。  |              |          |
| LTER_DATAONLY |                           |              |          |
+---------------+---------------------------+--------------+----------+
| EDIT          | Conductor作               | Condu        | 21       |
|               | 業一覧の更新を行います。  | ctor作業一覧 | 00180006 |
+---------------+---------------------------+--------------+----------+
| DOWNLOAD      | Conductor作業一           | Condu        | 21       |
|               | 覧の投入データ一式と結果  | ctor作業一覧 | 00180006 |
|               | データ一式を取得します。  |              |          |
+---------------+---------------------------+--------------+----------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _info-7:

INFO
~~~~

   Conductorクラスの列情報を取得します。

   ※詳細は『標準REST機能の利用』-『INFO(X-Command)』を参照

.. _filterfilter_dataonly-3:

FILTER・FILTER_DATAONLY
~~~~~~~~~~~~~~~~~~~~~~~

   パラメータで指定した条件に合致したレコードの、列情報（列番号と列名）および、

   通常ステータス（廃止または活性中）の全レコードの行数とレコード内容と列情報を取得します。

   FILTER_DATAONLYを指定した場合は列情報を省略します。

   ※詳細は『標準REST機能の利用』-『FILTER(X-Command)』を参照

.. _edit-3:

EDIT
~~~~

   Conductor作業一覧の更新、廃止、復活を行います。

   ただし、ロール・メニュー紐付管理で紐付が「メンテナンス可」の場合のみ行えます。

   ※詳細は『標準REST機能の利用』-『EDIT(X-Command)』を参照

.. _download-1:

DOWNLOAD
~~~~~~~~

　　　パラメータで指定した条件に合致したレコードの、投入データ一式と結果データ一式の

　　　ZipファイルをBASE64でエンコードして取得する。

**表 6-35** **Symphonyクラスパラメータ一覧**

+---------------------------------+------------------------------------+
| **項目キー名**                  | **パラメータ名**                   |
+=================================+====================================+
| CONDUCTOR_INSTANCE_NO           | 取得したいレコードのCon            |
|                                 | ductorインスタンスNoをカンマ区切り |
+---------------------------------+------------------------------------+

+-----------------------------------------------------------------------+
| **　                                                                  |
| 例）JSON記述例：**\ Conductor\ **インスタンスNo1と2を対象にした場合** |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "CONDUCTOR_INSTANCE_NO": [                                            |
|                                                                       |
| 　 "1",                                                               |
|                                                                       |
| "2"                                                                   |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

・レスポンス

1)レコード行数

（JSON形式）

キー{resultdata} -> キー{CONTENTS} -> キー{RECORD_LENGTH}の中に、

数値として格納されます。

2) レコード情報

（JSON形式）（1行につき1個の配列（列キーと列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
   キー{0}の中に0から始まる数値を、キーとする配列として格納されます。

**表 6-36** **レスポンスパラメータ一覧**

+-------------------------------+--------------------------------------+
|    列キー名                   |    列名                              |
+===============================+======================================+
| CONDUCTOR_INSTANCE_NO         | ConductorインスタンスNo              |
+-------------------------------+--------------------------------------+
| INPUT_DATA                    | 投入データ一式ファイル名             |
+-------------------------------+--------------------------------------+
| RESULT_DATA                   | 結果データ一式ファイル名             |
+-------------------------------+--------------------------------------+

3)ファイル情報

（JSON形式）（1行につき1個の配列（列キーと列別データ））

   キー{resultdata} -> キー{CONTENTS} -> キー{ DOWNLOAD_FILE} ->
   キー{0}の中に0から始まる数値を、キーとする配列として格納されます。

**表 6-37** **レスポンスパラメータ一覧**

+-------------------------------+---------------------------------------+
|    列キー名                   |    列名                               |
+===============================+=======================================+
| 投入データ一式ファイル名      | ダウンロー                            |
|                               | ドファイルをBASE64でエンコードした値  |
+-------------------------------+---------------------------------------+
| 結果データ一式ファイル名      | ダウンロー                            |
|                               | ドファイルをBASE64でエンコードした値  |
+-------------------------------+---------------------------------------+

..

   ・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| “RECORD_LENGTH”:取得件数                                              |
|                                                                       |
| "BODY": {                                                             |
|                                                                       |
| "0":{                                                                 |
|                                                                       |
| "CONDUCTOR_INSTANCE_NO": ConductorインスタンスNo                      |
|                                                                       |
| "INPUT_DATA ":投入データ一式ファイル名                                |
|                                                                       |
| "RESULT_DATA":結果データ一式ファイル名                                |
|                                                                       |
| },                                                                    |
|                                                                       |
| ・・・取得件数分繰り返し・・・                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| "DOWNLOAD_FILE:{                                                      |
|                                                                       |
| "0"{                                                                  |
|                                                                       |
| "投入                                                                 |
| データ一式ファイル名":ダウンロードファイルをBASE64でエンコードした値  |
|                                                                       |
| "結果                                                                 |
| データ一式ファイル名":ダウンロードファイルをBASE64でエンコードした値  |
|                                                                       |
| }                                                                     |
|                                                                       |
| ・・・取得件数分繰り返し・・・                                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

Movement利用編
==============

Movement作業実行を対象としたRestAPI
-----------------------------------

   Movementの操作をRestAPIで行うことができます。

   利用可能な機能は、以下メニューグループに該当する『作業実行』、『作業状態確認』に相当する操作です。

表 7‑1 作業実行、状態確認メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| Ansible-Legacy        | 作業実行                 | 2100020111       |
+-----------------------+--------------------------+------------------+
|                       | 作業状態確認             | 2100020112       |
+-----------------------+--------------------------+------------------+
| Ansible-Pioneer       | 作業実行                 | 2100020211       |
+-----------------------+--------------------------+------------------+
|                       | 作業状態確認             | 2100020212       |
+-----------------------+--------------------------+------------------+
| Ansible-LegacyRole    | 作業実行                 | 2100020312       |
+-----------------------+--------------------------+------------------+
|                       | 作業状態確認             | 2100020313       |
+-----------------------+--------------------------+------------------+
| Terraform             | 作業実行                 | 2100080009       |
+-----------------------+--------------------------+------------------+
|                       | 作業状態確認             | 2100080010       |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-13:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表6-3　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 7‑2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | EXECUTE                                                 |
|            |                                                         |
|            | CANCEL                                                  |
|            |                                                         |
|            | SCRAM                                                   |
|            |                                                         |
|            | の3つが選択可能                                         |
+------------+---------------------------------------------------------+

..

   X-Commandに指定可能なパラメータ

表 7‑3　X-Commandに指定可能なパラメータ一覧

+-----------+----------------------+------------------+---------------+
| X-Command | 説明                 | 対象画面         | メニューID    |
+===========+======================+==================+===============+
| EXECUTE   | 予約/                | 作業実行         | 2100020111    |
|           | 作業実行を行います。 |                  |               |
|           |                      |                  | 2100020211    |
|           |                      |                  |               |
|           |                      |                  | 2100020312    |
|           |                      |                  |               |
|           |                      |                  | 2100080009    |
+-----------+----------------------+------------------+---------------+
| CANCEL    | 予約                 | 作業状態確認     | 2100020112    |
|           | 取り消しを行います。 |                  |               |
|           |                      |                  | 2100020212    |
|           |                      |                  |               |
|           |                      |                  | 2100020313    |
|           |                      |                  |               |
|           |                      |                  | 2100080010    |
+-----------+----------------------+------------------+---------------+
| SCRAM     | 緊急停止を行います。 | 作業状態確認     |               |
+-----------+----------------------+------------------+---------------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

.. _レスポンスの項目-4:

レスポンスの項目
~~~~~~~~~~~~~~~~

以下では、それぞれのX-comannd実行時のレスポンス項目についての説明を行います。

表 7‑4　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| EXECUTION_NO         | 作業Noに対する操作に使用                      |
+----------------------+-----------------------------------------------+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：正常終了                              |
|                      |                                               |
|                      |    001：実行不可                              |
|                      |                                               |
|                      |    002：予約取消不可                          |
|                      |                                               |
|                      |    003：緊急停止不可                          |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+

.. _execute-6:

EXECUTE
~~~~~~~

   Movementクラスとオペレーションを指定して、作業実行を行います。予約日時の指定や、実行モード（ドライラン/実行）を指定できます。

   ができます。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

表 7‑5 Movement実行パラメータ一覧

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| MOVEMENT_CLASS_ID    | MovementクラスID                              |
+----------------------+-----------------------------------------------+
| OPERATION_ID         | オペレーションID                              |
+----------------------+-----------------------------------------------+
| PRESERVE_DATETIME    | 予約日時（YYYY/MM/DD ｔｔ:ｍｍ）              |
+----------------------+-----------------------------------------------+
| RUN_MODE             | 1：実行、                                     |
|                      |                                               |
|                      | 2：ドライラン                                 |
+----------------------+-----------------------------------------------+

+-----------------------------------------------------------------------+
| **例）JSON記述例**                                                    |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "MOVEMENT_CLASS_ID": 1,                                               |
|                                                                       |
| "OPERATION_ID": 1,                                                    |
|                                                                       |
| "PRESERVE_DATETIME": "2019/12/24 15:44",                              |
|                                                                       |
| "RUN_MODE": 1                                                         |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "EXECUTION_NO": "作業No",                                             |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

.. _cancel-2:

CANCEL
~~~~~~

   予約日時が登録されている作業Noを指定して、予約実行をキャンセルします。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 7‑6 Movement実行パラメータ一覧

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| EXECUTION_NO                   | 作業No※                             |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "EXECUTION_NO": "作業No",                                             |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

.. _scram-2:

SCRAM
~~~~~

   実行されている作業Noを指定して、緊急停止します。

   ・パラメータ

   　　以下をJSON形式でcontentに指定してください。

表 7‑7 Movement実行パラメータ一覧

+--------------------------------+-------------------------------------+
| パラメータ名                   | 設定値                              |
+================================+=====================================+
| EXECUTION_NO                   | 作業No※                             |
+--------------------------------+-------------------------------------+

..

   ※EXECUTEの返り値で取得したものです。

   ・レスポンス

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "EXECUTION_NO": "作業No",                                             |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報"                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

バージョン確認
==============

バージョン確認を対象としたRestAPI
---------------------------------

   インストールされているITAのバージョンとドライバーの一覧を取得するRestAPIを行うことができます。

   利用可能な機能は、メニューグループ[管理コンソール]の、[バージョン確認]メニューに相当する操作です。

表 8‑1メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| 管理コンソール        | バージョン確認           | 2100000299       |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-14:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表
   5‑19　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 8-2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | INFOが選択可能                                          |
+------------+---------------------------------------------------------+

.. _info-8:

INFO
~~~~

   ITA の各機能のバージョンを取得します。
   インストール済みの機能のみ取得できます。

表 8‑3 HTTPヘッダパラメータ一覧

+--------------------------------+-------------------------------------+
| HTTPヘッダ                     | 値                                  |
+================================+=====================================+
| X-Command                      | INFO                                |
+--------------------------------+-------------------------------------+

・レスポンス

1) レコード情報

（JSON形式）

キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
キー{version}の中に、

インストールされているITAのバージョンが格納されます。

キー{resultdata} -> キー{CONTENTS} -> キー{BODY} ->
キー{installed_driver}の中に、

インストールされているドライバーが、配列として格納されます。

   ・レスポンス

   返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "CONTENTS": {                                                         |
|                                                                       |
| "BODY": {                                                             |
|                                                                       |
| "version":インストールされているITAのバージョン                       |
|                                                                       |
| "installed_driver":[                                                  |
|                                                                       |
| ・・・インストールされているドライバーの一覧・・・                    |
|                                                                       |
| ]                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

比較実行
========

比較実行を対象としたRestAPI
---------------------------

   比較の操作をRestAPIで行うことができます。

   利用可能な機能は、以下メニューグループに該当する『比較実行』に相当する操作です。

表 9‑1 比較実行　メニュー一覧

+-----------------------+--------------------------+------------------+
| メニューグループ      | メニュー名               | メニューID       |
+=======================+==========================+==================+
| 比較                  | 比較実行                 | 2100190003       |
+-----------------------+--------------------------+------------------+

.. _リクエストの形式-15:

リクエストの形式
~~~~~~~~~~~~~~~~

   下記の情報でHTTPリクエストを発行します。

   ・パス

   https://<HostName>:<Port>/default/menu/07_rest_api_ver1.php?no=メニューID

   メニューIDは\ **『表6-3　X-Commandに指定可能なパラメータ一覧』**\ を参照してください\ **。**

・HTTPヘッダ

表 9‑2 HTTPヘッダパラメータ一覧

+------------+---------------------------------------------------------+
| HTTPヘッダ | 説明                                                    |
+============+=========================================================+
| Co         | “application/json”を指定する。                          |
| ntent-Type |                                                         |
+------------+---------------------------------------------------------+
| Aut        | ITAの認証要メニューにアクセスする場合は、               |
| horization |                                                         |
|            | 『ログインID』と『パスワード』\*                        |
|            | を、                                                    |
|            | 半角コロン(:)で結合して、base64encodeをした値、を指定。 |
+------------+---------------------------------------------------------+
| X-Command  | COMPARE                                                 |
+------------+---------------------------------------------------------+

..

   以下では、それぞれのX-comanndパラメータについての説明を行います。

COMPARE
~~~~~~~

   比較定義と基準日を指定して、比較実行を行います。

   対象ホストや出力内容（全件出力/差分のみ）、出力形式(CSV/EXCEL)を指定できます。

   ・パラメータ

   　以下をJSON形式でcontentに指定してください。

表 9‑3 比較実行パラメータ一覧

+----------------------+-----------------------------------------------+
| パラメータ名         | 設定値                                        |
+======================+===============================================+
| COMPARE_ID           | 比較定義ID                                    |
+----------------------+-----------------------------------------------+
| BASE_TIMESTAMP_0     | 比較対象メニュー1の基準日を指定 （YYYY/MM/DD  |
|                      | ｔｔ:ｍｍ）                                   |
+----------------------+-----------------------------------------------+
| BASE_TIMESTAMP_1     | 比較対象メニュー2の基準日を指定 （YYYY/MM/DD  |
|                      | ｔｔ:ｍｍ）                                   |
+----------------------+-----------------------------------------------+
| HOST_LIST            | 機器一覧IDカンマ区切り                        |
+----------------------+-----------------------------------------------+
| FORMATTER_ID         | 比較結果の出力形式                            |
|                      |                                               |
|                      | 1：CSV (デフォルト)                           |
|                      |                                               |
|                      | 2：Excel                                      |
+----------------------+-----------------------------------------------+
| OUTPUT_TYPE          | 比較結果の出力内容                            |
|                      |                                               |
|                      | 1:全件出力 (デフォルト)                       |
|                      |                                               |
|                      | 2:差分のみ                                    |
+----------------------+-----------------------------------------------+

+-----------------------------------------------------------------------+
| **例）JSON記述例**                                                    |
+=======================================================================+
| {                                                                     |
|                                                                       |
| "COMPARE_ID": "1",                                                    |
|                                                                       |
| "BASE_TIMESTAMP_0": "",                                               |
|                                                                       |
| "BASE_TIMESTAMP_1": "",                                               |
|                                                                       |
| "HOST_LIST ": "1,2,3",                                                |
|                                                                       |
| "FORMATTER_ID": "1",                                                  |
|                                                                       |
| "OUTPUT_TYPE": "1"                                                    |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

..

   ・レスポンス

   1) レコード情報

   （JSON形式）

   キー{resultdata} -> キー{CONTENTS}
   ->の中に、以下の項目が配列として格納されます。

表 9‑4　レスポンス項目一覧

+----------------------+-----------------------------------------------+
| 項目名               | 備考                                          |
+======================+===============================================+
| RESULTCODE           | コマンド実行の成否のコード                    |
|                      |                                               |
|                      |    000：比較                                  |
|                      |                                               |
|                      |    001：比較結果無し                          |
+----------------------+-----------------------------------------------+
| RESULTINFO           | 詳細情報                                      |
+----------------------+-----------------------------------------------+
| FILENAME             | 比較結果の出力ファイル名                      |
+----------------------+-----------------------------------------------+
| FILE                 | 比較結果をBASE64でエンコードした値            |
+----------------------+-----------------------------------------------+

..

   　　返されるレスポンスには、JSON形式で格納されています。

+-----------------------------------------------------------------------+
| {                                                                     |
|                                                                       |
| "status": "SUCCEED",                                                  |
|                                                                       |
| "resultdata": {                                                       |
|                                                                       |
| "RESULTCODE": "結果コード",                                           |
|                                                                       |
| "RESULTINFO": "詳細情報",                                             |
|                                                                       |
| "FILENAME": "ファイル名",                                             |
|                                                                       |
| "FILE": "比較結果をBASE64でエンコードした値"                          |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+=======================================================================+
|                                                                       |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

付録
====

トラブルシューティング
----------------------

+------+---------------------------------------------------------------+
|      | **内容**                                                      |
|   ** |                                                               |
| No** |                                                               |
+======+===============================================================+
|      | RESTAPIを使用したファイルアップロードに時間かかりすぎる       |
|  Q-1 |                                                               |
|      | RESTAPIでの登録処理中にエラーとなる                           |
|      |                                                               |
|      | RESTAPIで                                                     |
|      | ファイルアップロード実施中に、WEB画面上の表示、動作が重くなる |
+------+---------------------------------------------------------------+
| A-1  | PHPのメモリ設定が足りないことが考えられます。                 |
|      |                                                               |
|      |    PHP設定ファイル『php.ini』内の次のパラメ                   |
|      | ータの値を見直して、割り当て可能な最大値を設定してください。  |
|      |                                                               |
|      |    ・memory_limit PHPに割り当て可能なメモリ                   |
|      |                                                               |
|      |    ・post_max_size postデータに許可される最大サイズ           |
+------+---------------------------------------------------------------+
